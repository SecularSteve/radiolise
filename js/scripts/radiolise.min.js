function learnMore(){return UI.dialog.open("learnmore"),$("#infotext").text().replace(/          /g,"\n").trim()}function enableCoverArt(){Network.musicBrainz.coverart=!0,Network.musicBrainz.getCoverArt(info)}function addCustomStation(){currentlist.push({}),$("#customstations input").val(""),gearclicked=currentlist.length-1,UI.dialog.open("stationmanager")}var secondinterval,Data={refresh:function refresh(){var t={lists:lists,settings:settings,likes:likes,titles:titles},s=JSON.stringify(t);return s!=localStorage.data&&(localStorage.data=s,console.info("Storage data updated"),!0)},list:{sync:function sync(t){var s=JSON.parse(localStorage.data||defaultdata).lists;currentlist!=s&&(t?(lists[listname]=currentlist,Data.refresh()):(currentlist=s[listname]||[],lists[listname]=currentlist,UI.updateList(!1)))},stationExists:function stationExists(t){for(var s=0;s<currentlist.length;s++)if(currentlist[s].id==t)return!0;return!1}},settings:{load:function load(){$(".checked").removeClass("checked"),$("#theme").val(["pure","puredark","pure","chic","chicdark"][settings.theme-1]),(settings.changecolor||3==settings.theme)&&$("#colorchange").addClass("checked"),UI.settings.toggleThemeDescription(),settings.visualization&&$("#pseudovsl").addClass("checked"),settings.relax?($("#relaxmode").addClass("checked"),$("#relaxtimeoutdiv").show()):$("#relaxtimeoutdiv").hide(),$("#relaxtimeout").val(settings["relax-timeout"]),$("#defaultvolume").val(settings.volume),settings.transitions&&$("#transitions").addClass("checked"),settings.loadpolicy&&$("#loadpolicy").addClass("checked"),$("#locales").val(settings.language||"auto"),console.info("Initial values written into settings dialog")},save:function save(){switch($("#theme").val()){case"puredark":settings.theme=2;break;case"chic":settings.theme=4;break;case"chicdark":settings.theme=5;break;default:settings.theme=1;}settings.visualization=$("#pseudovsl").hasClass("checked"),settings.relax=$("#relaxmode").hasClass("checked"),settings["relax-timeout"]=+$("#relaxtimeout").val(),settings.changecolor=$("#colorchange").hasClass("checked"),settings.volume=+$("#defaultvolume").val(),settings.transitions=$("#transitions").hasClass("checked"),settings.loadpolicy=$("#loadpolicy").hasClass("checked"),settings.language=$("#locales").val(),settings.language==tr("en")||detected&&"auto"==settings.language||(player.paused?($(document).off("scroll"),$("html").html("<h1 style=\"font-family: Fira Sans, sans-serif\">"+tr("One moment please\u2026")+"</h1>"),Player.stream.stop(),location.reload()):UI.hint.show("<i class=\"fa fa-info-circle\"></i> "+tr("The page needs to be refreshed for all changes to take effect."))),"auto"!=settings.language&&($("#locales [value=auto]").text(tr("Detect")),detected=!1),UI.updateList(!1),Data.refresh(),UI.adjust()}},moveArrayIndex:function moveArrayIndex(t,s,a){if(gearclicked==s&&(gearclicked=a),a>=t.length)for(var o=a-t.length+1;o--;)t.push(void 0);return t.splice(a,0,t.splice(s,1)[0]),t},createBookmark:function createBookmark(t){var s=titles.favorites[titles.favorites.length-1];s&&s.station==t.station&&s.info==t.info?UI.message("<i class='fa fa-exclamation-triangle'></i> "+tr("You have already bookmarked this title.")):(t.time=Math.floor(+new Date/60),titles.favorites.push(t),Data.refresh(),$(".plushistory").addClass("active"),UI.hint.show("<i class='fa fa-check'></i> "+tr("Added to bookmarks")),UI.titleManager.insertList("favorites"))},offerUndeletion:function offerUndeletion(t,s,a,o){clearInterval(secondinterval),$("#progressbar").css({width:0,transition:"none"}),$("#restoretext").text(t),$("#footer").css({top:"calc(100% - "+$("#footer").height()+"px)",visibility:"visible"});var l=0,n=function(){l+=10,$("#progressbar").css({width:l+"%",transition:""}),110==l&&(clearInterval(secondinterval),$("#footer").css({top:"100%",visibility:"hidden"}))};n(),secondinterval=setInterval(n,1e3),$("#restore").off("click"),$("#restore").on("click",function(){"list"==a?lists=JSON.parse(s):"bookmarks"==a?titles.favorites=s.slice():window[a]=s.slice(),o(),$("#footer").css({top:"100%",visibility:"hidden"})})}},prevcolor,relaxed=!1,vinterval,Effects={changeColor:function changeColor(){var t=(settings.changecolor||3==settings.theme)&&!player.paused?"hsl("+20*currentstation.toUpperCase().charCodeAt(0)+", 50%, 60%)":"";t!=prevcolor&&(prevcolor=t,$("body").css({background:t.replace("60%","30%")}),$("body")[0].style.setProperty("--themecolor",t),console.info("Style color set"))},relaxMode:{enter:function enter(){prevdata!=nostream&&prevdata!=loading&&"#dialog"!=location.hash&&settings.relax&&0==player.videoHeight&&(relaxed=!0,vinterval==void 0&&Effects.visualization.enable(),$("body").addClass("relaxed").css({background:"hsl("+20*currentstation.toUpperCase().charCodeAt(0)+", 50%, 30%)"}),console.info("Entered relax mode"))},leave:function leave(){relaxed&&(relaxed=!1,!settings.visualization&&Effects.visualization.disable(),$("body").removeClass("relaxed"),!settings.changecolor&&3!=settings.theme&&$("body").css({background:""}),console.info("Left relax mode"))}},visualization:{enable:function enable(){(settings.visualization||relaxed)&&(vinterval=setInterval(function(){$("#visualization").children().each(function(){$(this).css({top:15*Math.random()+50+"%"})})},100),$("#visualization").show(),console.info("Pseudo-visualization shown"))},disable:function disable(){vinterval!=void 0&&(clearInterval(vinterval),vinterval=void 0,$("#visualization").children().css({top:"100%"}),$("#visualization").hide(),console.info("Pseudo-visualization hidden"))}}};function main(){function t(x){if(x=new RegExp("[?&]"+encodeURIComponent(x)+"=([^&]*)").exec(location.search))return decodeURIComponent(x[1])}function s(){if(!r||!1==r)for(var x in currentlist)currentlist[x].id==n&&Player.stream.start(currentlist[x])}function a(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?($(".fullscreen i").removeClass("fa-expand").addClass("fa-compress"),$("#video").addClass("fs"),$("#hint").prependTo("#video"),console.info("Entered fullscreen")):($(".fullscreen i").removeClass("fa-compress").addClass("fa-expand"),$("#video").removeClass("fs"),$("#hint").insertAfter("#modals"),clearTimeout(bartimer),console.info("Left fullscreen")),Player.showVideoBar(),$(document).trigger("scroll")}$("[tr]").each(function(){$(this).html(tr($(this).html()))}),$("[title]").each(function(){$(this).attr("title",tr($(this).attr("title")))}),$("[label]").each(function(){$(this).attr("label",tr($(this).attr("label")))}),$("[placeholder]").each(function(){$(this).attr("placeholder",tr($(this).attr("placeholder")))}),defaultdata="{\"lists\":{\""+tr("Favorites")+"\":[]},\"settings\":"+defaultsettings+",\"likes\":[],\"titles\":{\"history\":[],\"favorites\":[]}}";try{lists=JSON.parse(localStorage.data||defaultdata).lists}catch(x){lists=JSON.parse(defaultdata).lists}try{localStorage}catch(x){$("noscript")[0].outerHTML=$("noscript").text(),$("#initfail h1").text(tr("Please enable offline storage!")),$("#initfail p").text(tr("Offline storage is used to ensure that application data (e.g. stations and settings) won\u2019t get lost. This page does not collect any personal data. Third parties (broadcasters) might act differently."))}-1==navigator.userAgent.indexOf("Trident")||localStorage.try||($("noscript")[0].outerHTML=$("noscript").text(),$("#initfail h1").text(tr("Compatibility issues possible")),$("#initfail p").html(tr("Internet Explorer does not support some of the basic functionalities that this web application relies on.")+" <a href=\"#\" onclick=\"localStorage.try = '1'; location = location.href\">"+tr("Try anyway (may not work)")+"</a>")),listname=Object.keys(lists)[0],Data.settings.load(),likes=JSON.parse(localStorage.data||defaultdata).likes||[],titles=JSON.parse(localStorage.data||defaultdata).titles||{history:[],favorites:[]},$("html").attr("lang",tr("en")),"auto"==settings.language&&($("#locales [value=auto]").append(" ("+tr("en")+")"),detected=!0),nostream=tr("Ready"),loading="<i class='fa fa-spin fa-spinner'></i> "+tr("Loading\u2026"),console.info("Locale strings loaded"),Player.update.setName(nostream),localStorage.lastList&&setList(localStorage.lastList),$(".name").text(appname),$("#query").val(null);var o=decodeURIComponent(location.hash);if(""!==o){switch(o.substring(1)){case"dialog":break;default:UI.hint.show("<b>"+tr("Invalid hashtag")+"</b><br><br> "+tr("\u2018")+o+tr("\u2019 is unknown."));}history.replaceState({},document.title,".")}UI.adjust(),$("select:has([data-type])").prop("disabled",!0),applyLists(),player.volume=settings.volume/100,$("#volumeslider div").css({width:settings.volume+"%"}),Data.list.sync(!1),$("#relaxcaption").css({"font-size":Math.sqrt(1.2*$(window).width())+"pt"});var l=t("src"),n=t("id"),r=t("keepoff"),d=t("q");history.replaceState(null,null,"."),l&&(setList(tr("Added via ")+l),n?Data.list.stationExists(n)?s():$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+n,function(x){lists[tr("Added via ")+l]||(lists[tr("Added via ")+l]=[]),applyLists(),currentlist.push({name:x[0].name,url:x[0].url,homepage:x[0].homepage,icon:x[0].favicon,country:x[0].country,state:x[0].state,language:x[0].language,tags:x[0].tags,id:x[0].id}),UI.updateList(!0),s()}).fail(function(){UI.message(tr("Sorry, the station could not be added via ")+l+tr(" because a request failed."))}):d&&(applyLists(),setTimeout(function(){$("#query").val(d),UI.dialog.open("addstation")},0))),$("#hidefooter").on("click",function(){$("#footer").css({top:"100%",visibility:"hidden"})}),$("#chremove").on("click",function(){currentlist.splice(gearclicked,1),UI.updateList(!0),UI.dialog.close()}),$("body").on("keydown",function(x){32==x.which&&"#dialog"!=location.hash&&x.preventDefault()});var c=!1,p;$("body").on("keyup",function(x){var C=x.key;if(clearTimeout(p),!($("input").is(":focus")||x.ctrlKey||x.altKey||x.shiftKey||x.metaKey))switch(C){case"-":Player.volume.change(!1,!0);break;case"+":Player.volume.change(!0,!0);break;case" ":$(".stop").hasClass("disabled")||(UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-"+($(".stop i").hasClass("fa-play")?"play":"stop")+"'></i>",!0),$(".stop:first").trigger("click"));break;case"f":"none"==$(".fsdiv").css("display")?UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("No video stream")):$(".fullscreen").trigger("click");break;case"p":$(".prevstation:first").trigger("click"),UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-step-backward'></i>",!0);break;case"n":$(".nextstation:first").trigger("click"),UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-step-forward'></i>",!0);break;default:if(!isNaN(C)){var L=$("#hint span").html()||"";if(p=setTimeout(function(){if($("#hint span").length){var M=$("#hint span").html().replace(/–/g,"");c=!1,M<=currentlist.length&&0<M?(UI.hint.hide(),Player.stream.start(currentlist[M-1])):UI.hint.show("<i class='fa fa-fw fa-exclamation-triangle'></i> "+tr("Station ")+ +M+tr(" doesn\u2019t exist."))}},2e3),!c||!L.match(/–/g)){c=!0;for(var T="",S=0;S<currentlist.length.toString().length-1;S++)T+="\u2013";UI.hint.show("<span style='font-size: 32px'>"+C+T+"</span>",!0,!1)}else $("#hint span").html(L.replace("\u2013",C))}}"#dialog"==location.hash&&"Escape"==C&&history.back()}),$("[placeholder='"+tr("Tags")+"']").on("input",function(){UI.stationManager.refreshTagItems($(this).val())}),$("#customstations input").on("blur",function(){$("[placeholder='Name']").val()&&$("[placeholder='URL']").val()?(currentlist[gearclicked].name=$("[placeholder='"+tr("Name")+"']").val(),currentlist[gearclicked].url=$("[placeholder='"+tr("URL")+"']").val(),currentlist[gearclicked].homepage=$("[placeholder='"+tr("Homepage")+"']").val(),currentlist[gearclicked].icon=$("[placeholder='"+tr("Icon")+"']").val(),currentlist[gearclicked].country=$("[placeholder='"+tr("Country")+"']").val(),currentlist[gearclicked].state=$("[placeholder='"+tr("State")+"']").val(),currentlist[gearclicked].language=$("[placeholder='"+tr("Sprache")+"']").val(),currentlist[gearclicked].tags=$("[placeholder='"+tr("Tags")+"']").val(),Data.list.sync(!0),UI.updateList(!0)):UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("Saving failed: Bad station data"))}),$("#done").on("click",function(){UI.dialog.close()}),$(".menu").on("click",function(){UI.dialog.open("menu")}),$(".wrench").on("click",function(){UI.dialog.open("listmanager")}),$("#closesettings").on("click",function(){$("#discardsettings").trigger("click")}),$(".stop").on("click",function(){var x=$(this).children();x.hasClass("fa-stop")?(Player.stream.stop(),Player.update.setName(nostream)):prevstation==void 0?localStorage.lastStation?Player.stream.start(JSON.parse(localStorage.lastStation)):0<currentlist.length?Player.stream.start(currentlist[0]):UI.hint.show("<i class='fa fa-fw fa-exclamation-triangle'></i>"+tr("Please add a station to the list first.")):Player.stream.start(prevstation)}),$("#video .expand").on("click",function(){$("#infobox").is(":visible")?($("#infobox").slideUp(),$("#video .expand i").css({transform:"rotate(0deg)"}),$("#video").hasClass("fs")?$(".player > div").show():$(".player > div:not(.fsdiv)").show(),$("#video .station").css({maxWidth:0,whiteSpace:"nowrap"})):($("#infobox").slideDown(),$("#video .expand i").css({transform:"rotate(-180deg)"}),$(".player > div:not(.station, .fsdiv)").hide(),$("#video .station").css({maxWidth:"none",whiteSpace:"normal"})),$(document).trigger("scroll")}),$(":not(#video) .expand").on("click",function(){$("html").animate({scrollTop:0}),$("#infobox").is(":hidden")&&$("#video .expand").trigger("click")}),$(".station").on("click",function(){$(this).closest(".videobar").find(".expand").trigger("click")}),$("#showrecent").on("click",function(){"none"==$("#recent").css("display")?(UI.titleManager.insertList("history"),$("#recent").slideDown(),$("#showrecent i").css({transform:"rotate(-180deg)"}),UI.titleManager.updateTimes()):($("#recent").slideUp(),$(".reload").hide(),$("#showrecent i").css({transform:"rotate(0deg)"}))}),$("#showbookmarks").on("click",function(){"none"==$("#favorites").css("display")?($("#favorites").slideDown(),$("#showbookmarks i").css({transform:"rotate(-180deg)"})):($("#favorites").slideUp(),$("#showbookmarks i").css({transform:"rotate(0deg)"}),UI.titleManager.updateTimes())}),$(".reload a").on("click",function(){$(".reload").hide(),$("#recent").fadeOut(function(){UI.titleManager.insertList("history"),$("#recent").fadeIn()})}),$(".download a").on("click",function(){for(var L,x=moment(new Date).format("[# "+appname.toUpperCase()+" BOOKMARKS\n# As of:] L LT[\n\n]"),C=0;C<titles.favorites.length;C++)L=titles.favorites[C],x+=moment(60*L.time).format("- L LT | ["+L.info+" ("+L.station+")\n]");$("#blob").attr("href",URL.createObjectURL(new Blob([x],{type:"text/plain"}))),$("#blob").attr("download","Bookmarks_"+new Date().getTime()+".txt"),$("#blob")[0].click()}),$(".prevstation").on("click",function(){if(1<currentlist.length){var x=currentlist.indexOf(prevstation);0<x?Player.stream.start(currentlist[x-1]):0<=x&&Player.stream.start(currentlist[currentlist.length-1])}}),$(".nextstation").on("click",function(){if(1<currentlist.length){var x=currentlist.indexOf(prevstation);0<=x&&x<currentlist.length-1?Player.stream.start(currentlist[x+1]):0<=x&&Player.stream.start(currentlist[0])}}),$(".like").on("click",function(){Network.radioBrowser.likeStation(prevstation.id)}),$(".showhistory").on("click",function(){UI.dialog.open("history")}),$(".plushistory").on("click",function(){info&&"<br>"!=info?Data.createBookmark({station:currentstation,info:info,time:Math.floor(+new Date/60)}):UI.message("<i class='fa fa-exclamation-triangle'></i> Currently, there is no \u2018Now playing\u2019 information available.")}),$("#history").on("click",".listitem",function(){$(this).siblings().find(".options").slideUp(),$(this).find(".options").slideToggle()}),$("#history").on("click",".options",function(x){x.stopPropagation()}),$("#external").on("click",function(){Player.stream.stop()}),$("#vcontain").on("dblclick",function(){$(".fullscreen").trigger("click")}),$("#video").on("mousedown mouseup mousemove",function(){Player.showVideoBar()}),$("#tryfetch").on("click",function(){Network.radioBrowser.browse()}),$("#redoajax").on("click",function(){Network.radioBrowser.loadEntries(),UI.search.showLoadingInfo(),$("#failure").hide()}),$(".minus").on("click",function(){Player.volume.change(!1)}),$(".plus").on("click",function(){Player.volume.change(!0)}),$(".fullscreen").on("click",function(){var x=$("#video")[0];$(".fullscreen i").hasClass("fa-expand")?(x.requestFullscreen?x.requestFullscreen():x.msRequestFullscreen?x.msRequestFullscreen():x.mozRequestFullScreen?x.mozRequestFullScreen():x.webkitRequestFullscreen&&x.webkitRequestFullscreen(),$("#infobox").is(":visible")&&$("#video .expand").trigger("click")):(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),$("#video").removeClass("fs"))}),$("video").on("contextmenu",function(){return!1}),$(document).on("fullscreenchange",a).on("webkitfullscreenchange",a).on("mozfullscreenchange",a),$(window).on("hashchange",function(){""===location.hash&&1==$(".shown").length&&UI.dialog.close()}).on("dragstart",function(){return!1}).on("mousemove mousedown keydown touchstart",function(){settings.relax&&(clearTimeout(relaxtimer),Effects.relaxMode.leave(),relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"]))}).on("resize",function(){$("#relaxcaption").css({"font-size":Math.sqrt(1.2*$(window).width())+"pt"}),relaxed&&Effects.relaxMode.enter(),"visible"==$("#footer").css("visibility")&&$("#footer").css({top:"calc(100% - "+$("#footer").height()+"px)"}),"visible"==$("#addfooter").css("visibility")&&$("#addfooter").css({top:"calc(100% - "+$("#addfooter").height()+"px)"}),$(document).trigger("scroll")}),$("#findstation").on("click",function(){searching&&(UI.search.showLoadingInfo(),$("#modals").finish().animate({scrollTop:$("#query").offset().top-$(window).scrollTop()+$("#modals").scrollTop()}))}),$("#country").on("change",function(){$("#state").val(""),UI.search.refreshResults(),$.post("https://www.radio-browser.info/webservice/json/states",{country:$("#country").val()},function(x){var C="<option value=''>"+tr("All ")+tr("states")+"</option>";for(var L in x)C+="<option value='"+x[L].name+"'>"+x[L].name+"</option>";$("[data-type=states]").html(C)}).fail(function(){$("[data-type=states]").html("<option value=\"\">"+tr("Request failed")+"</option>"),$("#failmsg").slideDown()})}),$("#addstation select:not(#country)").on("change",UI.search.refreshResults),$("#moreoptions a").on("click",function(){"none"==$("#filters").css("display")?($("#filters").stop().slideDown(),$("#moreoptions span").text(tr("Hide options")),$("#moreoptions i").css({transform:"rotate(-180deg)"})):($("#filters").stop().slideUp(),$("#moreoptions span").text(tr("Show options")),$("#moreoptions i").css({transform:"rotate(0deg)"}))}),$("#query").on("keyup",function(x){13==x.which&&($("#findstation").trigger("click"),$("#query").blur())}).on("input",function(){fetch!=void 0&&"abort"in fetch&&fetch.abort(),offset=0,$("#loadmore").show(),Network.radioBrowser.loadEntries($("input").val().trim().replace(/\s+/g," ")),$("#findstation").removeClass("disabled"),$(".selected").trigger("click"),$("#loadmore").hide()}).on("focus",function(){$(this).parent().css({background:"rgba(0, 0, 0, .1)"})}).on("blur",function(){UI.search.showLoadingInfo(),$(this).parent().css({background:""})}),$("form").on("submit",function(x){x.preventDefault()}),$("#addlist").on("click",addList),$(".closer").on("click",function(){UI.dialog.close()}),$("#modals > div").on("click",function(x){x.stopPropagation()}),$(".addbutton").on("click",function(){UI.dialog.open("addstation")}),$(".settingsbutton").on("click",function(){UI.dialog.open("settings")}),$(".learnmorebutton").on("click",function(){UI.dialog.open("learnmore")}),$("#applysettings").on("click",function(){var x=!0;$("input[type=number]").each(function(){var C=+$(this).val();x&&($(this).attr("min")>C||$(this).attr("max")<C||Math.floor(C)!=C||""==$(this).val())&&(x=!1)}),x?(Data.settings.save(),UI.dialog.close()):UI.message(tr("At least one invalid number input has been detected."))}),$("#discardsettings").on("click",function(){settings=JSON.parse(localStorage.data||defaultdata).settings,Data.settings.load(),UI.dialog.close()}),$("#reset").on("click",function(){settings=JSON.parse(defaultsettings),Data.settings.load(),Data.settings.save()}),$(".checkable").on("click",function(){$(this).hasClass("checked")?($(this).removeClass("checked"),"relaxmode"==$(this).attr("id")&&$("#relaxtimeoutdiv").hide()):($(this).addClass("checked"),"relaxmode"==$(this).attr("id")&&$("#relaxtimeoutdiv").show()),($(this).is("#reverse")||$(this).is("#showbroken"))&&UI.search.refreshResults(),.5==$(this).css("opacity")&&UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("Screen or window not wide enough")+".")}).on("select",function(){return!1}),$("#listdl").on("change",function(){if("cancel"!=$(this).val()){var x,C;switch($(this).val()){case"m3u":x="#EXTM3U\n",C="audio/mpegurl",currentlist.forEach(function(L){x+="#EXTINF:-1,"+L.name+"\n"+L.url+"\n"});break;case"pls":x="[playlist]\n",C="audio/x-scpls",currentlist.forEach(function(L,T){x+="File"+ ++T+"="+L.url+"\nTitle"+T+"="+L.name+"\n"}),x+="Version=2\n";break;case"xspf":x="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<playlist version=\"1\" xmlns=\"http://xspf.org/ns/0/\">\n  <trackList>\n",C="application/xspf+xml",currentlist.forEach(function(L){x+="    <track>\n      <title>"+L.name+"</title>\n      <location>"+L.url+"</location>\n    </track>\n"}),x+="  </trackList>\n</playlist>\n";}$("#blob").attr("href",URL.createObjectURL(new Blob([x],{type:C}))),$("#blob").attr("download",listname.replace(/ /g,"_")+"_"+new Date().getTime()+"."+$(this).val()),$("#blob")[0].click()}$(this).val("icon")}),$("input[type=file]").on("change",function(x){var C=x.target.files[0],L=new FileReader;L.readAsText(C),L.onload=function(T){settings=JSON.parse(T.target.result),Data.settings.load(),Data.settings.save(),UI.hint.show(tr("Import successful."))},L.onerror=function(){UI.message(tr("Error reading file."))},$(this).val("")}),$("#import").on("click",function(){$("input[type=file]").trigger("click")}),$("#export").on("click",function(){Data.settings.save(),$("#blob").attr("href",URL.createObjectURL(new Blob([JSON.stringify(settings)],{type:"application/json"}))),$("#blob").attr("download","Settings_"+new Date().getTime()+".json"),$("#blob")[0].click()}),$(".minus, .plus, #volumeslider").on("DOMMouseScroll",function(x){x.preventDefault(),Player.volume.change(0>x.originalEvent.detail)}).on("mousewheel",function(x){x.preventDefault(),Player.volume.change(0<x.originalEvent.wheelDelta)}),$("#theme").on("change",UI.settings.toggleThemeDescription),$(document).on("scroll",function(){$(window).trigger("mousemove"),50>=$("#video").offset().top+$("#video").outerHeight()-$(".videobar").outerHeight()-$(window).scrollTop()&&!$("#video").hasClass("fs")?$("body").addClass("fixedplayer"):$("body").removeClass("fixedplayer")}),$(document).trigger("scroll"),$("#modals").on("scroll",function(){searching&&$("#addstation").hasClass("shown")&&0>$("#loadmore").offset().top-$(window).height()-$(window).scrollTop()&&(searching=!1,offset+=20,Network.radioBrowser.loadEntries())}),$("#lists").on("change",function(){if($(this).prop("selectedIndex")==$("#lists > optgroup > option").length)for(var x in setList(listname),UI.dialog.open("listmanager"),$("#listul").empty(),lists)$("#listul").append("<li>"+x+"</li>");else setList($(this).val())}),$(document).on("mousedown",".smartmenu",function(){m=!1,$("#tomove").hide()}).on("change",".smartmenu",function(){switch(gearclicked=$(this).index("#stations .smartmenu"),$(this).val()){case"homepage":open(currentlist[gearclicked].homepage,"_blank");break;case"like":Network.radioBrowser.likeStation(currentlist[gearclicked].id);break;case"edit":UI.dialog.open("stationmanager");break;case"moveup":Data.moveArrayIndex(currentlist,gearclicked,gearclicked-1),UI.updateList(!0);break;case"movedown":Data.moveArrayIndex(currentlist,gearclicked,gearclicked+1),UI.updateList(!0);break;case"delete":var x=currentlist.slice(),C=currentlist[gearclicked].name;currentlist.splice(gearclicked,1),UI.updateList(!0),Data.offerUndeletion(tr("Station named \u2018")+C+tr("\u2019 has been removed."),x,"currentlist",function(){UI.updateList(!0)});}$(this).val("icon")}),$("#addchecked").on("click",function(){$(".selected").each(function(){var C=$(this).data("meta");currentlist.push({name:C.name,url:C.url,homepage:C.homepage,icon:C.favicon,country:C.country,state:C.state,language:C.language,tags:C.tags,id:C.id})}),UI.updateList(!0),UI.dialog.close()}),$(document).on("blur",".itemname",function(){$(this).next().find(".okay").hide(),$(this).next().find(".renamelist").show();var x=$(this),C=$(this).closest("[data-item]").data("item"),L=x.val().trim().replace(/\s+/g," ")||null;C!=L&&(lists[L]==void 0?L?(lists[C]?(lists[L]=lists[C].slice(),delete lists[C]):(lists[L]=[],UI.hint.show(tr("New list named \u2018")+L+tr("\u2019 created"))),$("#lists").val()==C&&(listname=L),applyLists()):(UI.hint.show(tr("Invalid name")),applyLists()):(UI.hint.show(tr("Already existing")),applyLists()))}).on("focus",".itemname",function(){$(this).next().find(".okay").show(),$(this).next().find(".renamelist").hide(),$(this).select()}).on("keydown","div[data-item] > .itemname",function(x){13==x.which&&(x.preventDefault(),$(this).blur())}),$("#customstations input").on("keydown",function(x){13==x.which&&$(this).blur()}),$("#listtools").on("mouseenter",function(){$(this).css({opacity:1})}).on("mouseleave",function(){$(this).css({opacity:.5})}),$("#deselectall").on("click",function(){$(".selected").trigger("click")}),$("#results").on("click",".result",function(){if($(this).hasClass("selected")?($(this).removeClass("selected"),0==$(".selected").length&&$("#addfooter").css({top:"100%",visibility:"hidden"}),$(this).children().first().css({width:0,opacity:0})):Data.list.stationExists($(this).data("meta").id)?UI.message(tr("\u2018")+$(this).data("meta").name+tr("\u2019 has already been added to \u2018")+listname+tr("\u2019.")):($(this).addClass("selected"),$("#addfooter").css({top:"calc(100% - "+$("#addfooter").height()+"px)",visibility:"visible"}),$(this).children().first().css({width:"25px",opacity:1})),1==$(".selected").length?$("#stationcount").html(tr("\u2018")+$(".selected").data("meta").name+tr("\u2019")):$("#stationcount").html($(".selected").length+tr(" stations")),0<$(".selected").length){var x="calc(100% - "+$("#addfooter").height()+"px)";$("#addfooter").css({top:x}),$("#modals").css({height:x})}else $("#modals").css({height:"100%"})});var h=!1;$("#volumeslider").on("mousedown touchstart",function(x){h=!0,Player.volume.moveSlider(x)});var m=!1,f,u,g,v,b;$("#stations").on("mousedown","tr",function(x){m=!0,f=$(this).index(),b=f,u=$(this),$("#tomove").html(u[0].outerHTML.replace(/id=/g,"")),g=x.pageY,$("#tomove").css({height:u.height(),width:u.width(),left:u.offset().left,top:u.offset().top-$(window).scrollTop()})});var w;$(document).on("mousemove touchmove",function(x){if(m){$("html").addClass("dragging"),$("#tomove").show(),clearInterval(w),w=void 0,v=x.pageY;var C=function(T){b=Math.floor((T-$("#stations").offset().top)/$("#stations tr").height()),0>b?b=0:b>=$("#stations tr").length&&(b=$("#stations tr").length-1),$("#stations tr").removeClass("hovered"),$("#stations tr:nth-child("+(b+1)+")").addClass("hovered");var S=u.offset().top+T-g-$(window).scrollTop(),M=$("#stations").offset().top-$(window).scrollTop(),I=$("#stations").offset().top+$("#stations").height()-$("#tomove").height()-$(window).scrollTop();S<M?$("#tomove").css({transform:"translateY("+(M-S)+"px)"}):S>I?$("#tomove").css({transform:"translateY("+(I-S)+"px)"}):$("#tomove").css({transform:""}),$("#tomove").css({top:S})},L=parseInt($("#tomove").css("top"),10);L<=50+$(".videobar").outerHeight()?w=setInterval(function(){$(window).scrollTop($(window).scrollTop()-20),v-=20,C(v)},10):0>=$(window).height()-L-$("#tomove").height()?w=setInterval(function(){$(window).scrollTop($(window).scrollTop()+20),v+=20,C(v)},10):C(v)}else h&&Player.volume.moveSlider(x)}).on("mouseup touchend",function(){$("html").removeClass("dragging"),m?(m=!1,clearInterval(w),w=void 0,$("#tomove").hide(),$("#tomove").empty(),b!=f&&(Data.moveArrayIndex(currentlist,f,b),UI.updateList(!0)),$("#stations tr").removeClass("hovered")):h&&(h=!1)}).on("click","#stations tr",function(){$(this).hasClass("playing")?$(".stop:first").trigger("click"):Player.stream.start(currentlist[$(this).index()])}).on("click","#stations td:nth-child(3)",function(x){x.stopPropagation()})}var allids,liking=!1,searching=!1,Network={radioBrowser:{browse:function browse(){for(var t=["countries","states","languages"],s=0;s<t.length;s++)(function(a){var o=$("[data-type="+a+"]");o.parent().prop("disabled")&&$.post("https://www.radio-browser.info/webservice/json/"+a,function(l){var n="<option value=''>"+tr("All ")+tr(a)+"</option>";for(var r in l)n+="<option value='"+l[r].name+"'>"+l[r].name+"</option>";o.html(n).parent().prop("disabled",!1)}).fail(function(){o.html("<option value=\"\">"+tr("Request failed")+"</option>"),$("#failmsg").slideDown()})})(t[s])},likeStation:function likeStation(t){liking||-1!=likes.indexOf(t)?$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+t,function(s){UI.message(s[0].votes+"+"+tr(" people like this station.")+"<br>"+tr("You have already voted."))}):(liking=!0,$.post("https://www.radio-browser.info/webservice/json/vote/"+t,function(){if(likes.push(t),Data.refresh(),!player.paused&&prevstation.id==t){var a=$(".like").attr("title").split("\n").pop().split("+")[0];$(".like").attr("title",$(".like").attr("title").replace(a,++a))}$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+t,function(o){UI.message(o[0].votes+"+"+tr(" people like this station.")+"<br>"+tr("Your like has been submitted to the Community Radio Browser.")),$(".like").addClass("active"),$(".likecounter").text(o[0].votes)})}).fail(function(){navigator.onLine?UI.message(tr("Sorry, an error has occurred. Please try again later.")):UI.message(tr("Please make sure that you are online."))}).always(function(){liking=!1}))},loadEntries:function loadEntries(t){requesting=!0,fetch=$.post("https://www.radio-browser.info/webservice/json/stations/search",{name:t,offset:offset,limit:20,country:$("#country").val(),state:$("#state").val(),language:$("#language").val(),order:$("#order").val(),reverse:5>$("#order").prop("selectedIndex")?$("#reverse").hasClass("checked"):!$("#reverse").hasClass("checked")},function(s){$("#failure").hide(),requesting=!1;for(var a=0,o="",l=[null,"flag","map-marker","comment-alt fa-flip-horizontal","file-audio","play","thumbs-up"],n=0;n<s.length;n++){if($("#showbroken").hasClass("checked")||"1"==s[n].lastcheckok){var r=!0;for(var d in currentlist)if(currentlist[d].id==s[n].id){r=!1;break}if(o+="<div style='cursor: pointer; display: table; table-layout: fixed; width: 100%"+(r?"":"; opacity: .5; cursor: not-allowed' title='"+tr("This station has already been added to \u2018")+listname+tr("\u2019."))+"' data-meta='"+JSON.stringify(s[n]).replace(/'/g,"&apos;")+"' class='result'><div class='checkmark green' style='display: table-cell; opacity: 0; width: 0'><i class='fa fa-check' style='margin-left: 10px'></i></div><div style='padding: 10px; margin-bottom: 10px; display: table-cell'><h4 style='margin: 0'>"+(r?"":"<i class='fa fa-ban red'></i> ")+s[n].name+"</h4><br>"+(0==s[n].lastcheckok?"<span class='label red' style='font-weight: 500'>"+tr("BROKEN")+"</span> ":"")+(0<$("#order").prop("selectedIndex")?"<span class='label green' style='font-weight: 500'><i class='fa fa-"+l[$("#order").prop("selectedIndex")]+"'></i> "+(s[n][$("#order").val()]||"<i class='fa fa-question'></i>")+"</span> ":"")+(+s[n].hls?"<span class='label'>HLS</span> ":+s[n].bitrate?"<span class='label'>"+s[n].bitrate+" kBit/s</span> ":"")+(1==$("#order").prop("selectedIndex")?"":"<span class='label'>"+s[n].country+"</span> ")+(2==$("#order").prop("selectedIndex")?"":"<span class='label'>"+s[n].state+"</span> "),""!=s[n].tags)for(var d=0;d<s[n].tags.split(",").length;d++)o+="<span class='label'>"+s[n].tags.split(",")[d].trim()+"</span> ";else o+="<br>";o+="</div></div>"}else console.warn("'"+s[n].name+"' ["+(n+offset)+"] seems to be BROKEN.");a++}0==offset&&($("#results").empty(),$("#loadmore").show()),$("#results").append(o),20>a?(searching=!1,$("#loadmore").hide(),0==$("#results > div").length&&$("#results").html("<p style='font-size: 18px; text-align: center'><i class='far fa-fw fa-meh'></i>"+tr("No matching stations found.")+"</p>")):searching=!0,clearInterval(closetimer),$("#results").show(),console.info("Got "+$("#results > div").length+" results."),$("#modals").trigger("scroll")}).fail(function(s){"abort"!=s.statusText&&(searching=!1,requesting=!1,$("#loadmore").hide(),$("#results").hide(),$("#failure").show())})}},musicBrainz:{findAlbum:function findAlbum(t,s){t.match(/ \/ | - |: /g)?$.get("https://musicbrainz.org/ws/2/recording/?fmt=json&query="+encodeURIComponent(t.replace(/ \/ | - |: /g," AND ")),function(a){if(a.count){for(var c,o=a.recordings[0],l=o.title,n=o["artist-credit"][0].artist.name,r=[],d=0;d<a.count;d++)if(c=a.recordings[d],c)for(var p=c.releases||[],h=0;h<p.length;h++){var m=p[h],f=m["release-group"].id;-1!=r.indexOf(f)||s==f||m["release-group"]["secondary-types"]&&-1==m["release-group"]["secondary-types"].indexOf("Soundtrack")||-1==t.toLowerCase().indexOf(m.media[0].track[0].title.toLowerCase())||c.title!=m.title&&m["artist-credit"]&&n!=m["artist-credit"][0].artist.name||r.push(f)}Network.musicBrainz.requestCover(r,l,!1)}else console.log("Nothing found")}).fail(function(){console.log("It failed! Sorry\u2026")}):console.log("Malformed title")},requestCover:function requestCover(t,s,a){console.log(t),t.length?$.get("https://coverartarchive.org/release-group/"+t[0],function(o){console.log("SUCCESS");for(var l=o.images[0].thumbnails.large,n=0;n<o.images.length;n++)if(o.images[n].front){l=o.images[n].thumbnails.large;break}$("#vcontain").css({"background-image":"url("+l+")"})}).fail(function(){Network.musicBrainz.requestCover(t.slice(1),s,a)}):a?Network.musicBrainz.findAlbum(s,allids):console.log("Nothing found")},coverart:!1,getCoverArt:function getCoverArt(t){if(Network.musicBrainz.coverart){if($("#vcontain").show(),!t||-1!=t.toLowerCase().indexOf(currentstation.toLowerCase()))return void console.log("Invalid song title");$("#coverart h3").text(t);var s=t.replace(","," ").replace(/[^feat.a-zA-Z\d!\s:\/-]/g,"*");$.get("https://musicbrainz.org/ws/2/release-group/?fmt=json&query="+encodeURIComponent(s.replace(/ \/ | - |: /g," AND ")),function(a){for(var n,o=[],l=0;l<a.count;l++)n=a["release-groups"][l],n&&100==n.score&&("Single"==n["primary-type"]||"EP"==n["primary-type"])&&-1!=t.toLowerCase().indexOf(n["artist-credit"][0].artist.name.toLowerCase())&&o.push(n.id);allids=o,Network.musicBrainz.requestCover(o,s,!0)}).fail(function(){console.log("It failed! Sorry\u2026")})}}}},hasvideo,updatetimer,info,bartimer,Player={volume:{change:function change(t,s){var a=player.volume;t?a+=.1:a-=.1,1<a?a=1:0>a&&(a=0),player.volume=a.toFixed(1);var o=100*player.volume;s&&UI.hint.show("<i style='font-size: 60px' class='fa fa-volume-"+(0<o?"up":"off")+"'></i><div style='font-size: 25px'>"+(0<o?o+"%":tr("Off"))+"</div>",!0),$("#volumeslider div").css({width:o+"%"})},moveSlider:function moveSlider(t){t.preventDefault();var s=+(((t.type.startsWith("touch")?t.changedTouches[0].pageX:t.pageX)-$("#volumeslider").offset().left)/$("#volumeslider").width()).toFixed(2);0>s?s=0:1<s&&(s=1),player.volume=s,$("#volumeslider div").css({width:(100*s).toFixed()+"%"})}},update:{setName:function setName(t){prevdata!=t&&($(".broadcaster").attr("title",t),t==nostream?(t=nostream,$("#tags").slideUp(),$(".like, .homepage, .plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()}),$("title").html(appname),Effects.changeColor(),Effects.visualization.disable(),Effects.relaxMode.leave(),$(".stop").children().removeClass("fa-stop").addClass("fa-play")):(t!=loading&&($("title").html(t+" - "+appname),currentstation=t,Effects.changeColor(),vinterval==void 0&&Effects.visualization.enable(),settings.relax&&(clearTimeout(relaxtimer),relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"]))),$(".stop").children().removeClass("fa-play").addClass("fa-stop")),$(".broadcaster").css({opacity:0}),setTimeout(function(){$(".broadcaster, #relaxcaption div:eq(0)").html(t).css({opacity:1})},400),prevdata=t)},setInfo:function setInfo(t){if(t!=info){if($(".info").attr("title",t),$(".info").css({opacity:0}),setTimeout(function(){$(".info, #relaxcaption div:eq(1)").html(t).css({opacity:1})},400),"<br>"==t)$("#vcontain").hide(),$(".info").slideUp();else if($("#vcontain").css({"background-image":""}),Network.musicBrainz.getCoverArt(t),$(".info").slideDown(),t){$(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideDown():$(this).show()});for(var s=0;s<titles.history.length;s++)titles.history[s].station==currentstation&&titles.history[s].info==t&&titles.history.splice(s,1);5==titles.history.length&&titles.history.splice(0,1),titles.history.push({station:currentstation,info:t,time:Math.floor(+new Date/60)}),Data.refresh();var a=titles.favorites[titles.favorites.length-1];a&&a.station==currentstation&&a.info==t?$(".plushistory").addClass("active"):$(".plushistory").removeClass("active"),$("#recent").is(":visible")&&JSON.stringify(titles.history)!=$("#recent").data("content")&&$(".reload").show()}else $(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()});info=t}}},stream:{start:function start(t){var l=function(){Player.update.setName("<i class='fa fa-spin fa-spinner'></i> "+tr("Loading\u2026"))};Player.stream.stop(),l(),$("body").css({scrollTop:0}),UI.assignStatePlaying(t),$("#tags").html("<span class='label'>"+t.country.trim()+"</span> <span class='label'>"+t.state.trim()+"</span> ");var s=t.tags.split(",");for(var a in s)$("#tags").append("<span class='label'>"+s[a].trim()+"</span> ");$("#tags").slideDown(),$(".like, .homepage").each(function(){$(this).closest("#infobox").length?$(this).slideDown():$(this).show()}),$(".homepage").attr("href",t.homepage).attr("title",tr("Visit homepage")+"\n"+new URL(t.homepage).hostname),-1!=likes.indexOf(t.id)&&$(".like").addClass("active"),$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+t.id,function(n){$(".like").attr("title",tr("Like")+"\n"+n[0].votes+"+"+tr(" people like this station.")),$(".likecounter").text(n[0].votes)}),player.ontimeupdate=function(){hasvideo!=0<player.videoHeight&&(hasvideo=0<player.videoHeight,0<player.videoHeight?($("#vcontain").show(),$(".fsdiv").show(),$(document).trigger("scroll"),Effects.relaxMode.leave()):$("#vcontain").hide())},player.onloadedmetadata=function(){prevstation=t,localStorage.lastStation=JSON.stringify(t),Player.update.setName(t.name);var n=function(){metarequest=$.post("https://service.radiolise.com/",{url:player.src},function(r){var d=r.name||t.name;if(Player.update.setName(d),r.title||!$("<div/>").html(info).text()){var c=r.title||r.description||"";d.toLowerCase()==c.toLowerCase()?Player.update.setInfo("<br>"):Player.update.setInfo(c)}}).always(function(){updatetimer||(updatetimer=setTimeout(function(){updatetimer=void 0,n()},1e4))})};n(),$("#external").attr("href",t.url),$("#external").show(),console.info("Started streaming '"+t.name+"'")},player.onwaiting=function(){prevdata!=loading&&UI.hint.show("load")},player.oncanplay=function(){UI.hint.hide()},player.load();var o=function(n){n||(n=""),navigator.onLine?"m3u8"==function(r){if(!r)return"";var d=r.lastIndexOf("/");return-1!==d&&(r=r.substring(d+1)),d=r.indexOf("?"),-1!==d&&(r=r.substring(0,d)),d=r.indexOf("#"),-1!==d&&(r=r.substring(0,d)),d=r.lastIndexOf("."),-1===d?"":r.substring(d+1)}(n)?(l(),hls.loadSource("https:"==location.protocol?n.replace("http:","https:"):n),hls.attachMedia(player)):(player.setAttribute("src",n),player.play().catch(function(r){errormessage=r.message,Player.stream.stop(),"AbortError"==r.name?Player.update.setName(nostream):"NotAllowedError"==r.name?(UI.message(tr("User gesture seems to be required. Click on \u2018")+t.name+tr("\u2019 to start the stream.")),Player.update.setName(nostream)):n.endsWith("/;")?(UI.message(tr("Sorry, an error has occurred. ")+errormessage),Player.update.setName(nostream)):(n==t.url?o((n+"/;").replace("//;","/;")):o(t.url),UI.assignStatePlaying(t))})):(Player.stream.stop(),Player.update.setName(nostream),UI.message(tr("Please make sure that you are online.")))};t.id?$.post("https://www.radio-browser.info/webservice/v2/json/url/"+t.id,function(n){o(n.url)}).fail(function(){o(t.url)}):o(t.url)},stop:function stop(){$("#vcontain").hide(),$(".fsdiv").hide(),$(".like").removeClass("active"),$(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()}),$(document).trigger("scroll"),hasvideo=!1,$(".fullscreen i").hasClass("fa-compress")&&$(".fullscreen").trigger("click"),hls.detachMedia(),hls.stopLoad(),$(".stop").children().hasClass("fa-stop")&&console.info("Stopped streaming"),UI.assignStatePlaying(null),$("#hint").find(".fa-spinner").length&&UI.hint.hide(),player.onerror=null,player.removeAttribute("src"),player.load(),Effects.visualization.disable(),Player.update.setInfo("<br>"),metarequest&&metarequest.abort(),clearTimeout(updatetimer),updatetimer=void 0}},showVideoBar:function showVideoBar(){clearTimeout(bartimer),$(".videobar, .stationdiv").finish().show(),$("#video").css({cursor:"auto"}),0<player.videoHeight&&$("#video").hasClass("fs")&&(bartimer=setTimeout(function(){$(".videobar, .stationdiv").fadeOut(),$("#video").css({cursor:"none"})},3e3))}},modaltimer,closetimer,UI={adjust:function adjust(){$("#themestyle").attr("href","css/"+(["pure-dark","pure","chic","chic-dark"][settings.theme-2]||"pure")+".css?v=3"),$("#splash").css({"background-image":"none","pointer-events":"none",opacity:0}),setTimeout(function(){$("#splash").remove()},2e3),(""==prevcolor||3!=settings.theme)&&Effects.changeColor(),player.paused||(settings.visualization?vinterval==void 0&&Effects.visualization.enable():Effects.visualization.disable(),clearTimeout(relaxtimer)),settings.transitions?$("#notransitions").remove():0==$("#notransitions").length&&$("head").append("<style id=\"notransitions\">\n  * {\n    transition: none !important;\n  }\n</style>"),console.info("User interface adjusted")},assignStatePlaying:function assignStatePlaying(t){if($("#stations .playbutton > i").addClass("fa-play").removeClass("fa-stop"),$("#stations > tr").removeClass("playing"),t)for(var s in currentlist)JSON.stringify(currentlist[s])==JSON.stringify(t)&&($("#stations .playbutton:eq("+s+") > i").addClass("fa-stop").removeClass("fa-play"),$("#stations > tr:eq("+s+")").addClass("playing"))},updateList:function updateList(t){t&&Data.list.sync(!0),$("#stations").empty();for(var a,s=0;s<currentlist.length;s++){a="<tr><td style='vertical-align: middle'><div><div class='playbutton'><i style='display: table-cell; vertical-align: middle' class='fa fa-fw fa-play'></i></div><div class='icontain'><img class='icon' src='"+(settings.loadpolicy?currentlist[s].icon:"")+"' onerror='$(this).replaceWith(\"<div class=\\\"icon\\\" style=\\\"background: hsl("+20*currentlist[s].name.toUpperCase().charCodeAt(0)+", 50%, 50%)\\\"><span>"+currentlist[s].name[0].toUpperCase()+"</span></div>\")'></div></div></td><td><div style='display: block; padding-bottom: 20px'><div><h4 style='font-weight: 500; display: inline'>"+currentlist[s].name+"</h4></div></div><div style='position: relative; overflow: hidden; height: 30px'><div style='position: absolute; overflow-x: scroll; overflow-y: hidden; width: 100%' class='tags'><div style='white-space: nowrap; height: 30px'><span class='label'>"+currentlist[s].country+"</span> <span class='label'>"+currentlist[s].state+"</span> ";for(var o=0;o<currentlist[s].tags.split(",").length;o++)a+="<span class='label'>"+currentlist[s].tags.split(",")[o].trim()+"</span> ";a+="</div></div></div></div></td><td style='padding-right: 15px'><select class='smartmenu' title='"+tr("Options for \u2018")+currentlist[s].name+tr("\u2019")+"'><option selected hidden value='icon'>&#xf142;&nbsp;</option><optgroup label='"+tr("Options for \u2018")+currentlist[s].name+tr("\u2019")+"'><option value='like'>"+tr("Like")+"</option><option value='homepage'>"+tr("Visit homepage")+"</option><option value='edit'>"+tr("Edit")+"</option>"+(0<s?"<option value='moveup'>"+tr("Move up")+"</option>":"")+(s<currentlist.length-1?"<option value='movedown'>"+tr("Move down")+"</option>":"")+"<option value='delete'>"+tr("Delete")+"</option></optgroup><option>"+tr("Cancel")+"</option></select></td></tr>",$("#stations").append(a)}player.paused||UI.assignStatePlaying(prevstation),0==currentlist.length?$("#zero").show():($("#zero").hide(),$("#stations").show())},hint:{show:function show(t,s,a){clearTimeout(hinttimer),$("#navbar, .videobar").css({opacity:.5}),$("#hint").css({opacity:1,visibility:"visible"}),"load"==t?0==$("#hint .fa-spinner").length&&$("#hint > div").html("<i style='font-size: 60px; margin: 16px 0' class='fa fa-spinner fa-spin'></i>"):$("#hint > div").html(t);var o=5e3;a?$("#hint > div").append("<div style='text-align: right'><a onclick='UI.hint.hide()' class='button'>"+tr("OK")+"</a></div>"):"load"!=t&&(hinttimer=setTimeout(function(){UI.hint.hide()},o)),s||"load"==t?($("#hint > div").css({width:"100px"}),o=2e3):$("#hint > div").css({width:"300px"}),$("#hint > div").css({transform:"scale(1, 1)"})},hide:function hide(){$("#navbar, .videobar").css({opacity:1}),$("#hint").css({opacity:0,visibility:"hidden"}),$("#hint > div").css({transform:"scale(1, .5)"})}},message:function message(t){UI.hint.show(t,!1,!0)},dialog:{open:function open(t){var s=function(a){"hint"!=a&&($("#modals").css({left:"0",opacity:1,visibility:"visible","pointer-events":"auto"}),$("body").addClass("dialog")),"addstation"==a?(Network.radioBrowser.browse(),$("#query").trigger("input"),$("#loadmore").show(),setTimeout(function(){$("#query").select()},100)):"stationmanager"==a?($("#stationname").text(currentlist[gearclicked].name),$("#customstations").show(),$("[placeholder='"+tr("Name")+"']").val(currentlist[gearclicked].name),$("[placeholder='"+tr("URL")+"']").val(currentlist[gearclicked].url),$("[placeholder='"+tr("Homepage")+"']").val(currentlist[gearclicked].homepage),$("[placeholder='"+tr("Icon")+"']").val(currentlist[gearclicked].icon),$("[placeholder='"+tr("Country")+"']").val(currentlist[gearclicked].country),$("[placeholder='"+tr("State")+"']").val(currentlist[gearclicked].state),$("[placeholder='"+tr("Language")+"']").val(currentlist[gearclicked].language),$("[placeholder='"+tr("Tags")+"']").val(currentlist[gearclicked].tags),UI.stationManager.refreshTagItems(currentlist[gearclicked].tags||"")):"history"==a&&(UI.titleManager.insertList("favorites"),UI.titleManager.updateTimes()),$("#modals").scrollTop(0),$("#"+a).show().addClass("shown"),$("#modals > div:not(#"+a+")").hide(),"hint"!=a&&history.pushState(null,null,"#dialog"),Effects.relaxMode.leave(),console.info("Dialog with tag ID "+a+" shown")};"#dialog"==location.hash?$(".shown").attr("id")!=t||"stationmanager"==t?(clearTimeout(modaltimer),modaltimer=setTimeout(function(){s(t)},400),UI.dialog.close(!0)):UI.dialog.close():s(t)},close:function close(t){"listmanager"==$(".shown").attr("id")&&applyLists(),$("#modals").css({left:"-200px",opacity:0,visibility:"hidden","pointer-events":"none"}),t||$("body").removeClass("dialog"),"#dialog"==location.hash&&(history.back(),$(window).trigger("mousemove")),$(".shown").has("#addstation")&&($("#addfooter").css({top:"100%",visibility:"hidden"}),$("#modals").css({height:"100%"}),closetimer=setTimeout(function(){$("#query").val(""),$("#results").hide()},400)),$(".shown").removeClass("shown"),clearTimeout(relaxtimer),settings.relax&&(relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"])),console.info("Dialog hidden")}},search:{refreshResults:function refreshResults(){$("#query").trigger("input"),UI.search.showLoadingInfo()},showLoadingInfo:function showLoadingInfo(){requesting&&($("#results").empty(),$("#loadmore").show())}},settings:{toggleThemeDescription:function toggleThemeDescription(){$("#descriptions > span").hide(),$("#"+$("#theme").val()).show()}},stationManager:{refreshTagItems:function refreshTagItems(t){if($("#preview").empty(),t.trim()){var s=t.split(",");for(var a in s)$("#preview").append("<span class='label'>"+s[a].trim()+"</span> ");$("#tagview").show()}else $("#tagview").hide()}},titleManager:{insertList:function insertList(t){moment.locale(language);var s="";if(0<titles[t].length)for(var a,l,o=titles[t].length-1;0<=o;o--){if(l=titles[t][o],"favorites"==t){var n=moment(60*l.time).format("MMMM YYYY");a!=n&&(s+="<div class='monthseparator' style='margin: 10px 0; padding: 5px 10px; font-size: 20px; font-weight: 500; opacity: .7'>"+n+"</div>",a=moment(60*l.time).format("MMMM YYYY"))}s+="<div class='listitem' style='padding: 10px'><div style='margin-bottom: 5px; font-weight: normal; font-size: 17px; font-weight: 500'>"+l.info+"</div><div style='opacity: .7'><span style='float: left'>"+l.station+"</span>&nbsp;<span data-time='"+l.time+"' style='float: right'>"+moment(60*l.time).fromNow()+"</span></div><div class='options' style='display: none'>"+("favorites"==t?"<a class='button' href='https://musicbrainz.org/search?query="+encodeURIComponent(l.info)+"&type=recording' target='_blank' style='margin-bottom: 0'><i class='fa fa-fw fa-search'></i><span tr>MusicBrainz</span></a><a class='button' style='margin-bottom: 0' onclick='Data.offerUndeletion(\""+tr("\u2018")+l.info+tr("\u2019 has been removed from bookmarks.")+"\", titles.favorites.slice(), \"bookmarks\", function() {Data.refresh(); UI.titleManager.insertList(\"favorites\")}); titles.favorites.splice("+o+", 1); Data.refresh(); UI.titleManager.insertList(\"favorites\")'><i class='fa fa-fw fa-times'></i><span>"+tr("Remove")+"</span></a>":"<a class='button' style='margin-bottom: 0' onclick='Data.createBookmark("+JSON.stringify(l)+")'><i class='fa fa-music'></i><i class='fa fa-fw fa-xs fa-plus' style='vertical-align: super; margin: 0'></i><span>"+tr("Bookmark")+"</span></a><a class='button' href='https://musicbrainz.org/search?query="+encodeURIComponent(l.info)+"&type=recording' target='_blank' style='margin-bottom: 0'><i class='fa fa-fw fa-search'></i><span tr>MusicBrainz</span></a>")+"</div></div>"}else s+=tr("<p style='padding: 0; text-align: center'>"+tr("This list is currently empty.")+"</p>");if($("#"+("favorites"==t?"favorites":"recent")).html(s).data("content",JSON.stringify(titles[t])),"favorites"==t){var r=titles.favorites[titles.favorites.length-1];r&&r.station==currentstation&&r.info==info?$(".plushistory").addClass("active"):$(".plushistory").removeClass("active"),0<titles.favorites.length?$(".download").show():$(".download").hide()}console.info("Wrote "+t)},updateTimes:function updateTimes(){timeupdater&&clearTimeout(timeupdater),timeupdater=setInterval(function(){var t=0;$("#history").hasClass("shown")&&$(":visible > .listitem [data-time]").each(function(){var s=moment(60*$(this).data("time")).fromNow();$(this).text()!=s&&$(this).text(s),t++}),0==t&&clearTimeout(timeupdater)},5e3)}}};window.onunload=Player.stream.stop;function tr(t){return i18next.t(t)}window.onoffline=function(){player.paused||UI.message(tr("Oh no! The stream was interrupted due to a sudden disconnect.")),Player.stream.stop(),Player.update.setName(nostream)},"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js");var lists,settings,currentstation,prevdata,prevvolume,prevstation,defaultdata,loading,gearclicked,hinttimer,volumetimer,volumerequest,slow,timedout,relaxtimer,currentlist,likes,titles,fetch,nostream,listname,metarequest,timeupdater,defaultsettings="{\"theme\":4,\"visualization\":false,\"relax\":false,\"relax-timeout\":10,\"changecolor\":false,\"volume\":100,\"transitions\":true,\"loadpolicy\":true,\"language\":\"auto\"}",player=$("video")[0],appname=$("title").text(),visible=!1,listsbackup={},ismousedown=!1;console.log("%c Welcome to "+appname+"! ","font-size: 30px; background-color: #ccc; color: #000; font-family: sans-serif"),console.log("%c > and Happy Hacking!_","font-size: 20px"),console.log("%c\nhttps://gitlab.com/radiolise/radiolise.gitlab.io\n\n","font-family: sans-serif; font-size: 14px"),console.info("%c"+appname+" is free software, and you are welcome to redistribute it under certain conditions; type%c learnMore() %cfor details.","font-size: 14px; font-family: sans-serif","font-size: 14px","font-size: 14px; font-family: sans-serif"),player.onpause=function(){Player.stream.stop(),Player.update.setName(nostream)},player.onplay=function(){null==player.getAttribute("src")&&$(".stop:first").trigger("click")},$("title").text(appname);var hls=new Hls,errormessage;hls.on(Hls.Events.MANIFEST_PARSED,function(){UI.hint.hide(),player.play()}),hls.on(Hls.Events.ERROR,function(t,s){Player.stream.stop(),Player.update.setName(nostream),UI.message(tr("Sorry, an error has occurred. ")+(Hls.isSupported()?"levelLoadTimeOut"==s.details?tr("Timeout: Your network connection seems to be too slow at the moment."):s.details:tr("The stream may need a protocol like HLS, which doesn\u2019t seem to be supported by your browser.")))});function setList(t){$("#lists").val(t),listname!=t&&(listname=t,Data.list.sync(!1),localStorage.lastList=t)}function addList(){0==$("[data-item=\"\"]").length&&appendList(""),$("div[data-item=\"\"] > input").attr("placeholder",tr("Please specify a name")).select();var t=$("div[data-item=\"\"]").offset().top+$("#modals").scrollTop()-$("body").scrollTop();$("#modals").animate({scrollTop:t})}function removeList(t){var s=JSON.stringify(lists);delete lists[t],applyLists(),t==listname&&setList($("#lists > optgroup > option").html()),Data.offerUndeletion(tr("List named \u2018")+t+tr("\u2019 has been removed."),s,"list",applyLists)}function renameList(t){$("div[data-item=\""+t+"\"] > .itemname").focus()}function applyLists(){for(var t in Data.refresh(),$("#listdiv").empty(),$("#lists > optgroup").empty(),lists)$("#lists > optgroup").append("<option>"+t+"</option>"),appendList(t);$("#lists").val(listname)}function appendList(t){var s=document.createElement("input");s.setAttribute("class","itemname"),s.setAttribute("placeholder",tr("New name")),s.setAttribute("value",t);var a=document.createElement("div");a.setAttribute("data-item",t),a.setAttribute("style","display: table-row"),a.innerHTML=s.outerHTML+"<div style='display: table-cell; white-space: nowrap'><a class='renamelist' onclick='renameList($(this).closest(\"[data-item]\").data(\"item\"))'><i class='fa fa-fw fa-edit'></i></a><a class='okay' style='display: none'><i class='fa fa-fw fa-check'></i></a>"+(""!=t&&1<Object.keys(lists).length?"<a onclick='removeList($(this).closest(\"[data-item]\").data(\"item\"))'><i class='fa fa-fw fa-trash'></i></a>":"")+"</div>",$("#listdiv").append(a)}var languages=[];try{settings=JSON.parse(localStorage.data||"{\"settings\":"+defaultsettings+"}").settings}catch(t){settings=JSON.parse(defaultsettings)}var prevlanguage=settings.language||"auto",language=prevlanguage;"auto"==language&&(language=navigator.language.substring(0,2),navigator.languages!=void 0&&(languages=navigator.languages.slice(),$.each(languages,function(t,s){languages[t]=s.substring(0,2)}),languages=Array.from(new Set(languages.slice(0,languages.includes("en")?languages.indexOf("en"):Infinity)))));var detected=!1;i18next.use(i18nextXHRBackend).init({lng:"en"==language?null:language,fallbackLng:languages,nsSeparator:null,keySeparator:null,backend:{loadPath:"locales/{{lng}}.json?v=3"}},main);
