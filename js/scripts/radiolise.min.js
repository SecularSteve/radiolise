function learnMore(){return UI.dialog.open("learnmore"),$("#infotext").text().replace(/          /g,"\n").trim()}function enableCoverArt(){Network.musicBrainz.coverart=!0,Network.musicBrainz.getCoverArt(info)}function addCustomStation(){currentlist.push({}),$("#customstations input").val(""),gearclicked=currentlist.length-1,UI.dialog.open("stationmanager")}var secondinterval;const Data={refresh:function(){var e={lists:lists,settings:settings,likes:likes,titles:titles},t=JSON.stringify(e);return t!=localStorage.data&&(localStorage.data=t,console.info("Storage data updated"),!0)},list:{sync:function(e){var t=JSON.parse(localStorage.data||defaultdata).lists;currentlist!=t&&(e?(lists[listname]=currentlist,Data.refresh()):(currentlist=t[listname]||[],lists[listname]=currentlist,UI.updateList(!1)))},stationExists:function(e){for(var t=0;t<currentlist.length;t++)if(currentlist[t].id==e)return!0;return!1}},settings:{load:function(){$(".checked").removeClass("checked"),$("#theme").val(["pure","puredark","pure","chic","chicdark"][settings.theme-1]),(settings.changecolor||3==settings.theme)&&$("#colorchange").addClass("checked"),UI.settings.toggleThemeDescription(),settings.visualization&&$("#pseudovsl").addClass("checked"),settings.relax?($("#relaxmode").addClass("checked"),$("#relaxtimeoutdiv").show()):$("#relaxtimeoutdiv").hide(),$("#relaxtimeout").val(settings["relax-timeout"]),$("#defaultvolume").val(settings.volume),settings.transitions&&$("#transitions").addClass("checked"),settings.loadpolicy&&$("#loadpolicy").addClass("checked"),$("#locales").val(settings.language||"auto"),console.info("Initial values written into settings dialog")},save:function(){switch($("#theme").val()){case"puredark":settings.theme=2;break;case"chic":settings.theme=4;break;case"chicdark":settings.theme=5;break;default:settings.theme=1;}settings.visualization=$("#pseudovsl").hasClass("checked"),settings.relax=$("#relaxmode").hasClass("checked"),settings["relax-timeout"]=+$("#relaxtimeout").val(),settings.changecolor=$("#colorchange").hasClass("checked"),settings.volume=+$("#defaultvolume").val(),settings.transitions=$("#transitions").hasClass("checked"),settings.loadpolicy=$("#loadpolicy").hasClass("checked"),settings.language=$("#locales").val(),settings.language==tr("en")||detected&&"auto"==settings.language||(player.paused?($(document).off("scroll"),$("html").html("<h1 style=\"font-family: Fira Sans, sans-serif\">"+tr("One moment please\u2026")+"</h1>"),Player.stream.stop(),location.reload()):UI.hint.show("<i class=\"fa fa-info-circle\"></i> "+tr("The page needs to be refreshed for all changes to take effect."))),"auto"!=settings.language&&($("#locales [value=auto]").text(tr("Detect")),detected=!1),UI.updateList(!1),Data.refresh(),UI.adjust()}},moveArrayIndex:function(e,t,s){if(gearclicked==t&&(gearclicked=s),s>=e.length)for(var a=s-e.length+1;a--;)e.push(void 0);return e.splice(s,0,e.splice(t,1)[0]),e},createBookmark:function(e){var t=titles.favorites[titles.favorites.length-1];t&&t.station==e.station&&t.info==e.info?UI.message("<i class='fa fa-exclamation-triangle'></i> "+tr("You have already bookmarked this title.")):(e.time=Math.floor(+new Date/60),titles.favorites.push(e),Data.refresh(),$(".plushistory").addClass("active"),UI.hint.show("<i class='fa fa-check'></i> "+tr("Added to bookmarks")),UI.titleManager.insertList("favorites"))},offerUndeletion:function(e,t,s,a){clearInterval(secondinterval),$("#progressbar").css({width:0,transition:"none"}),$("#restoretext").text(e),$("#footer").css({top:"calc(100% - "+$("#footer").height()+"px)",visibility:"visible"});var o=0,l=function(){o+=10,$("#progressbar").css({width:o+"%",transition:""}),110==o&&(clearInterval(secondinterval),$("#footer").css({top:"100%",visibility:"hidden"}))};l(),secondinterval=setInterval(l,1e3),$("#restore").off("click"),$("#restore").on("click",function(){"list"==s?lists=JSON.parse(t):"bookmarks"==s?titles.favorites=t.slice():window[s]=t.slice(),a(),$("#footer").css({top:"100%",visibility:"hidden"})})}};var prevcolor,vinterval,relaxed=!1;const Effects={changeColor:function(){var e=(settings.changecolor||3==settings.theme)&&!player.paused?"hsl("+20*currentstation.toUpperCase().charCodeAt(0)+", 50%, 60%)":"";e!=prevcolor&&(prevcolor=e,$("body").css({background:e.replace("60%","30%")}),$("body")[0].style.setProperty("--themecolor",e),console.info("Style color set"))},relaxMode:{enter:function(){prevdata!=nostream&&prevdata!=loading&&"#dialog"!=location.hash&&settings.relax&&0==player.videoHeight&&(relaxed=!0,vinterval==null&&Effects.visualization.enable(),$("body").addClass("relaxed").css({background:"hsl("+20*currentstation.toUpperCase().charCodeAt(0)+", 50%, 30%)"}),console.info("Entered relax mode"))},leave:function(){relaxed&&(relaxed=!1,!settings.visualization&&Effects.visualization.disable(),$("body").removeClass("relaxed"),!settings.changecolor&&3!=settings.theme&&$("body").css({background:""}),console.info("Left relax mode"))}},visualization:{enable:function(){(settings.visualization||relaxed)&&(vinterval=setInterval(function(){$("#visualization").children().each(function(){$(this).css({top:15*Math.random()+50+"%"})})},100),$("#visualization").show(),console.info("Pseudo-visualization shown"))},disable:function(){vinterval!=null&&(clearInterval(vinterval),vinterval=void 0,$("#visualization").children().css({top:"100%"}),$("#visualization").hide(),console.info("Pseudo-visualization hidden"))}}};function main(){function e(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(location.search))return decodeURIComponent(e[1])}function t(){if(!l||!1==l)for(var e in currentlist)currentlist[e].id==o&&Player.stream.start(currentlist[e])}function s(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?($(".fullscreen i").removeClass("fa-expand").addClass("fa-compress"),$("#video").addClass("fs"),$("#hint").prependTo("#video"),console.info("Entered fullscreen")):($(".fullscreen i").removeClass("fa-compress").addClass("fa-expand"),$("#video").removeClass("fs"),$("#hint").insertAfter("#modals"),clearTimeout(bartimer),console.info("Left fullscreen")),Player.showVideoBar(),$(document).trigger("scroll")}$("[tr]").each(function(){$(this).html(tr($(this).html()))}),$("[title]").each(function(){$(this).attr("title",tr($(this).attr("title")))}),$("[label]").each(function(){$(this).attr("label",tr($(this).attr("label")))}),$("[placeholder]").each(function(){$(this).attr("placeholder",tr($(this).attr("placeholder")))}),defaultdata="{\"lists\":{\""+tr("Favorites")+"\":[]},\"settings\":"+defaultsettings+",\"likes\":[],\"titles\":{\"history\":[],\"favorites\":[]}}";try{lists=JSON.parse(localStorage.data||defaultdata).lists}catch(t){lists=JSON.parse(defaultdata).lists}try{localStorage}catch(t){$("noscript")[0].outerHTML=$("noscript").text(),$("#initfail h1").text(tr("Please enable offline storage!")),$("#initfail p").text(tr("Offline storage is used to ensure that application data (e.g. stations and settings) won\u2019t get lost. This page does not collect any personal data. Third parties (broadcasters) might act differently."))}-1==navigator.userAgent.indexOf("Trident")||localStorage.try||($("noscript")[0].outerHTML=$("noscript").text(),$("#initfail h1").text(tr("Compatibility issues possible")),$("#initfail p").html(tr("Internet Explorer does not support some of the basic functionalities that this web application relies on.")+" <a href=\"#\" onclick=\"localStorage.try = '1'; location = location.href\">"+tr("Try anyway (may not work)")+"</a>")),listname=Object.keys(lists)[0],Data.settings.load(),likes=JSON.parse(localStorage.data||defaultdata).likes||[],titles=JSON.parse(localStorage.data||defaultdata).titles||{history:[],favorites:[]},$("html").attr("lang",tr("en")),"auto"==settings.language&&($("#locales [value=auto]").append(" ("+tr("en")+")"),detected=!0),nostream=tr("Ready"),loading="<i class='fa fa-spin fa-spinner'></i> "+tr("Loading\u2026"),console.info("Locale strings loaded"),Player.update.setName(nostream),localStorage.lastList&&setList(localStorage.lastList),$(".name").text(appname),$("#query").val(null);var a=decodeURIComponent(location.hash);if(""!==a){switch(a.substring(1)){case"dialog":break;default:UI.hint.show("<b>"+tr("Invalid hashtag")+"</b><br><br> "+tr("\u2018")+a+tr("\u2019 is unknown."));}history.replaceState({},document.title,".")}UI.adjust(),$("select:has([data-type])").prop("disabled",!0),applyLists(),player.volume=settings.volume/100,$("#volumeslider div").css({width:settings.volume+"%"}),Data.list.sync(!1),$("#relaxcaption").css({"font-size":Math.sqrt(1.2*$(window).width())+"pt"});var i=e("src"),o=e("id"),l=e("keepoff"),n=e("q");history.replaceState(null,null,"."),i&&(setList(tr("Added via ")+i),o?Data.list.stationExists(o)?t():$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+o,function(e){lists[tr("Added via ")+i]||(lists[tr("Added via ")+i]=[]),applyLists(),currentlist.push({name:e[0].name,url:e[0].url,homepage:e[0].homepage,icon:e[0].favicon,country:e[0].country,state:e[0].state,language:e[0].language,tags:e[0].tags,id:e[0].id}),UI.updateList(!0),t()}).fail(function(){UI.message(tr("Sorry, the station could not be added via ")+i+tr(" because a request failed."))}):n&&(applyLists(),setTimeout(function(){$("#query").val(n),UI.dialog.open("addstation")},0))),$("#hidefooter").on("click",function(){$("#footer").css({top:"100%",visibility:"hidden"})}),$("#chremove").on("click",function(){currentlist.splice(gearclicked,1),UI.updateList(!0),UI.dialog.close()}),$("body").on("keydown",function(e){32==e.which&&"#dialog"!=location.hash&&e.preventDefault()});var r,d=!1;$("body").on("keyup",function(e){var t=e.key;if(clearTimeout(r),!($("input").is(":focus")||e.ctrlKey||e.altKey||e.shiftKey||e.metaKey))switch(t){case"-":Player.volume.change(!1,!0);break;case"+":Player.volume.change(!0,!0);break;case" ":$(".stop").hasClass("disabled")||(UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-"+($(".stop i").hasClass("fa-play")?"play":"stop")+"'></i>",!0),$(".stop:first").trigger("click"));break;case"f":"none"==$(".fsdiv").css("display")?UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("No video stream")):$(".fullscreen").trigger("click");break;case"p":$(".prevstation:first").trigger("click"),UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-step-backward'></i>",!0);break;case"n":$(".nextstation:first").trigger("click"),UI.hint.show("<i style='font-size: 60px; margin: 16px 0' class='fa fa-step-forward'></i>",!0);break;default:if(!isNaN(t)){var s=$("#hint span").html()||"";if(r=setTimeout(function(){if($("#hint span").length){var e=$("#hint span").html().replace(/–/g,"");d=!1,e<=currentlist.length&&0<e?(UI.hint.hide(),Player.stream.start(currentlist[e-1])):UI.hint.show("<i class='fa fa-fw fa-exclamation-triangle'></i> "+tr("Station ")+ +e+tr(" doesn\u2019t exist."))}},2e3),!d||!s.match(/–/g)){d=!0;for(var a="",o=0;o<currentlist.length.toString().length-1;o++)a+="\u2013";UI.hint.show("<span style='font-size: 32px'>"+t+a+"</span>",!0,!1)}else $("#hint span").html(s.replace("\u2013",t))}}"#dialog"==location.hash&&"Escape"==t&&history.back()}),$("[placeholder='"+tr("Tags")+"']").on("input",function(){UI.stationManager.refreshTagItems($(this).val())}),$("#customstations input").on("blur",function(){$("[placeholder='Name']").val()&&$("[placeholder='URL']").val()?(currentlist[gearclicked].name=$("[placeholder='"+tr("Name")+"']").val(),currentlist[gearclicked].url=$("[placeholder='"+tr("URL")+"']").val(),currentlist[gearclicked].homepage=$("[placeholder='"+tr("Homepage")+"']").val(),currentlist[gearclicked].icon=$("[placeholder='"+tr("Icon")+"']").val(),currentlist[gearclicked].country=$("[placeholder='"+tr("Country")+"']").val(),currentlist[gearclicked].state=$("[placeholder='"+tr("State")+"']").val(),currentlist[gearclicked].language=$("[placeholder='"+tr("Sprache")+"']").val(),currentlist[gearclicked].tags=$("[placeholder='"+tr("Tags")+"']").val(),Data.list.sync(!0),UI.updateList(!0)):UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("Saving failed: Bad station data"))}),$("#done").on("click",function(){UI.dialog.close()}),$(".menu").on("click",function(){UI.dialog.open("menu")}),$(".wrench").on("click",function(){UI.dialog.open("listmanager")}),$("#closesettings").on("click",function(){$("#discardsettings").trigger("click")}),$(".stop").on("click",function(){var e=$(this).children();e.hasClass("fa-stop")?(Player.stream.stop(),Player.update.setName(nostream)):prevstation==null?localStorage.lastStation?Player.stream.start(JSON.parse(localStorage.lastStation)):0<currentlist.length?Player.stream.start(currentlist[0]):UI.hint.show("<i class='fa fa-fw fa-exclamation-triangle'></i>"+tr("Please add a station to the list first.")):Player.stream.start(prevstation)}),$("#video .expand").on("click",function(){$("#infobox").is(":visible")?($("#infobox").slideUp(),$("#video .expand i").css({transform:"rotate(0deg)"}),$("#video").hasClass("fs")?$(".player > div").show():$(".player > div:not(.fsdiv)").show(),$("#video .station").css({maxWidth:0,whiteSpace:"nowrap"})):($("#infobox").slideDown(),$("#video .expand i").css({transform:"rotate(-180deg)"}),$(".player > div:not(.station, .fsdiv)").hide(),$("#video .station").css({maxWidth:"none",whiteSpace:"normal"})),$(document).trigger("scroll")}),$(":not(#video) .expand").on("click",function(){$("html").animate({scrollTop:0}),$("#infobox").is(":hidden")&&$("#video .expand").trigger("click")}),$(".station").on("click",function(){$(this).closest(".videobar").find(".expand").trigger("click")}),$("#showrecent").on("click",function(){"none"==$("#recent").css("display")?(UI.titleManager.insertList("history"),$("#recent").slideDown(),$("#showrecent i").css({transform:"rotate(-180deg)"}),UI.titleManager.updateTimes()):($("#recent").slideUp(),$(".reload").hide(),$("#showrecent i").css({transform:"rotate(0deg)"}))}),$("#showbookmarks").on("click",function(){"none"==$("#favorites").css("display")?($("#favorites").slideDown(),$("#showbookmarks i").css({transform:"rotate(-180deg)"})):($("#favorites").slideUp(),$("#showbookmarks i").css({transform:"rotate(0deg)"}),UI.titleManager.updateTimes())}),$(".reload a").on("click",function(){$(".reload").hide(),$("#recent").fadeOut(function(){UI.titleManager.insertList("history"),$("#recent").fadeIn()})}),$(".download a").on("click",function(){for(var e,t=moment(new Date).format("[# "+appname.toUpperCase()+" BOOKMARKS\n# As of:] L LT[\n\n]"),s=0;s<titles.favorites.length;s++)e=titles.favorites[s],t+=moment(60*e.time).format("- L LT | ["+e.info+" ("+e.station+")\n]");$("#blob").attr("href",URL.createObjectURL(new Blob([t],{type:"text/plain"}))),$("#blob").attr("download","Bookmarks_"+new Date().getTime()+".txt"),$("#blob")[0].click()}),$(".prevstation").on("click",function(){if(1<currentlist.length){var e=currentlist.indexOf(prevstation);0<e?Player.stream.start(currentlist[e-1]):0<=e&&Player.stream.start(currentlist[currentlist.length-1])}}),$(".nextstation").on("click",function(){if(1<currentlist.length){var e=currentlist.indexOf(prevstation);0<=e&&e<currentlist.length-1?Player.stream.start(currentlist[e+1]):0<=e&&Player.stream.start(currentlist[0])}}),$(".like").on("click",function(){Network.radioBrowser.likeStation(prevstation.id)}),$(".showhistory").on("click",function(){UI.dialog.open("history")}),$(".plushistory").on("click",function(){info&&"<br>"!=info?Data.createBookmark({station:currentstation,info:info,time:Math.floor(+new Date/60)}):UI.message("<i class='fa fa-exclamation-triangle'></i> Currently, there is no \u2018Now playing\u2019 information available.")}),$("#history").on("click",".listitem",function(){$(this).siblings().find(".options").slideUp(),$(this).find(".options").slideToggle()}),$("#history").on("click",".options",function(t){t.stopPropagation()}),$("#external").on("click",function(){Player.stream.stop()}),$("#vcontain").on("dblclick",function(){$(".fullscreen").trigger("click")}),$("#video").on("mousedown mouseup mousemove",function(){Player.showVideoBar()}),$("#tryfetch").on("click",function(){Network.radioBrowser.browse()}),$("#redoajax").on("click",function(){Network.radioBrowser.loadEntries(),UI.search.showLoadingInfo(),$("#failure").hide()}),$(".minus").on("click",function(){Player.volume.change(!1)}),$(".plus").on("click",function(){Player.volume.change(!0)}),$(".fullscreen").on("click",function(){var e=$("#video")[0];$(".fullscreen i").hasClass("fa-expand")?(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(),$("#infobox").is(":visible")&&$("#video .expand").trigger("click")):(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),$("#video").removeClass("fs"))}),$("video").on("contextmenu",function(){return!1}),$(document).on("fullscreenchange",s).on("webkitfullscreenchange",s).on("mozfullscreenchange",s),$(window).on("hashchange",function(){""===location.hash&&1==$(".shown").length&&UI.dialog.close()}).on("dragstart",function(){return!1}).on("mousemove mousedown keydown touchstart",function(){settings.relax&&(clearTimeout(relaxtimer),Effects.relaxMode.leave(),relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"]))}).on("resize",function(){$("#relaxcaption").css({"font-size":Math.sqrt(1.2*$(window).width())+"pt"}),relaxed&&Effects.relaxMode.enter(),"visible"==$("#footer").css("visibility")&&$("#footer").css({top:"calc(100% - "+$("#footer").height()+"px)"}),"visible"==$("#addfooter").css("visibility")&&$("#addfooter").css({top:"calc(100% - "+$("#addfooter").height()+"px)"}),$(document).trigger("scroll")}),$("#findstation").on("click",function(){searching&&(UI.search.showLoadingInfo(),$("#modals").finish().animate({scrollTop:$("#query").offset().top-$(window).scrollTop()+$("#modals").scrollTop()}))}),$("#country").on("change",function(){$("#state").val(""),UI.search.refreshResults(),$.post("https://www.radio-browser.info/webservice/json/states",{country:$("#country").val()},function(e){var t="<option value=''>"+tr("All ")+tr("states")+"</option>";for(var s in e)t+="<option value='"+e[s].name+"'>"+e[s].name+"</option>";$("[data-type=states]").html(t)}).fail(function(){$("[data-type=states]").html("<option value=\"\">"+tr("Request failed")+"</option>"),$("#failmsg").slideDown()})}),$("#addstation select:not(#country)").on("change",UI.search.refreshResults),$("#moreoptions a").on("click",function(){"none"==$("#filters").css("display")?($("#filters").stop().slideDown(),$("#moreoptions span").text(tr("Hide options")),$("#moreoptions i").css({transform:"rotate(-180deg)"})):($("#filters").stop().slideUp(),$("#moreoptions span").text(tr("Show options")),$("#moreoptions i").css({transform:"rotate(0deg)"}))}),$("#query").on("keyup",function(e){13==e.which&&($("#findstation").trigger("click"),$("#query").blur())}).on("input",function(){fetch!=null&&"abort"in fetch&&fetch.abort(),offset=0,$("#loadmore").show(),Network.radioBrowser.loadEntries($("input").val().trim().replace(/\s+/g," ")),$("#findstation").removeClass("disabled"),$(".selected").trigger("click"),$("#loadmore").hide()}).on("focus",function(){$(this).parent().css({background:"rgba(0, 0, 0, .1)"})}).on("blur",function(){UI.search.showLoadingInfo(),$(this).parent().css({background:""})}),$("form").on("submit",function(e){e.preventDefault()}),$("#addlist").on("click",addList),$(".closer").on("click",function(){UI.dialog.close()}),$("#modals > div").on("click",function(e){e.stopPropagation()}),$(".addbutton").on("click",function(){UI.dialog.open("addstation")}),$(".settingsbutton").on("click",function(){UI.dialog.open("settings")}),$(".learnmorebutton").on("click",function(){UI.dialog.open("learnmore")}),$("#applysettings").on("click",function(){var e=!0;$("input[type=number]").each(function(){var t=+$(this).val();e&&($(this).attr("min")>t||$(this).attr("max")<t||Math.floor(t)!=t||""==$(this).val())&&(e=!1)}),e?(Data.settings.save(),UI.dialog.close()):UI.message(tr("At least one invalid number input has been detected."))}),$("#discardsettings").on("click",function(){settings=JSON.parse(localStorage.data||defaultdata).settings,Data.settings.load(),UI.dialog.close()}),$("#reset").on("click",function(){settings=JSON.parse(defaultsettings),Data.settings.load(),Data.settings.save()}),$(".checkable").on("click",function(){$(this).hasClass("checked")?($(this).removeClass("checked"),"relaxmode"==$(this).attr("id")&&$("#relaxtimeoutdiv").hide()):($(this).addClass("checked"),"relaxmode"==$(this).attr("id")&&$("#relaxtimeoutdiv").show()),($(this).is("#reverse")||$(this).is("#showbroken"))&&UI.search.refreshResults(),.5==$(this).css("opacity")&&UI.hint.show("<i class='fa fa-exclamation-triangle'></i> "+tr("Screen or window not wide enough")+".")}).on("select",function(){return!1}),$("#listdl").on("change",function(){if("cancel"!=$(this).val()){var e,t;switch($(this).val()){case"m3u":e="#EXTM3U\n",t="audio/mpegurl",currentlist.forEach(function(t){e+="#EXTINF:-1,"+t.name+"\n"+t.url+"\n"});break;case"pls":e="[playlist]\n",t="audio/x-scpls",currentlist.forEach(function(t,s){e+="File"+ ++s+"="+t.url+"\nTitle"+s+"="+t.name+"\n"}),e+="Version=2\n";break;case"xspf":e="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<playlist version=\"1\" xmlns=\"http://xspf.org/ns/0/\">\n  <trackList>\n",t="application/xspf+xml",currentlist.forEach(function(t){e+="    <track>\n      <title>"+t.name+"</title>\n      <location>"+t.url+"</location>\n    </track>\n"}),e+="  </trackList>\n</playlist>\n";}$("#blob").attr("href",URL.createObjectURL(new Blob([e],{type:t}))),$("#blob").attr("download",listname.replace(/ /g,"_")+"_"+new Date().getTime()+"."+$(this).val()),$("#blob")[0].click()}$(this).val("icon")}),$("input[type=file]").on("change",function(e){var t=e.target.files[0],s=new FileReader;s.readAsText(t),s.onload=function(e){settings=JSON.parse(e.target.result),Data.settings.load(),Data.settings.save(),UI.hint.show(tr("Import successful."))},s.onerror=function(){UI.message(tr("Error reading file."))},$(this).val("")}),$("#import").on("click",function(){$("input[type=file]").trigger("click")}),$("#export").on("click",function(){Data.settings.save(),$("#blob").attr("href",URL.createObjectURL(new Blob([JSON.stringify(settings)],{type:"application/json"}))),$("#blob").attr("download","Settings_"+new Date().getTime()+".json"),$("#blob")[0].click()}),$(".minus, .plus, #volumeslider").on("DOMMouseScroll",function(e){e.preventDefault(),Player.volume.change(0>e.originalEvent.detail)}).on("mousewheel",function(e){e.preventDefault(),Player.volume.change(0<e.originalEvent.wheelDelta)}),$("#theme").on("change",UI.settings.toggleThemeDescription),$(document).on("scroll",function(){$(window).trigger("mousemove"),50>=$("#video").offset().top+$("#video").outerHeight()-$(".videobar").outerHeight()-$(window).scrollTop()&&!$("#video").hasClass("fs")?$("body").addClass("fixedplayer"):$("body").removeClass("fixedplayer")}),$(document).trigger("scroll"),$("#modals").on("scroll",function(){searching&&$("#addstation").hasClass("shown")&&0>$("#loadmore").offset().top-$(window).height()-$(window).scrollTop()&&(searching=!1,offset+=20,Network.radioBrowser.loadEntries())}),$("#lists").on("change",function(){if($(this).prop("selectedIndex")==$("#lists > optgroup > option").length)for(var e in setList(listname),UI.dialog.open("listmanager"),$("#listul").empty(),lists)$("#listul").append("<li>"+e+"</li>");else setList($(this).val())}),$(document).on("mousedown",".smartmenu",function(){f=!1,$("#tomove").hide()}).on("change",".smartmenu",function(){switch(gearclicked=$(this).index("#stations .smartmenu"),$(this).val()){case"homepage":open(currentlist[gearclicked].homepage,"_blank");break;case"like":Network.radioBrowser.likeStation(currentlist[gearclicked].id);break;case"edit":UI.dialog.open("stationmanager");break;case"moveup":Data.moveArrayIndex(currentlist,gearclicked,gearclicked-1),UI.updateList(!0);break;case"movedown":Data.moveArrayIndex(currentlist,gearclicked,gearclicked+1),UI.updateList(!0);break;case"delete":var e=currentlist.slice(),t=currentlist[gearclicked].name;currentlist.splice(gearclicked,1),UI.updateList(!0),Data.offerUndeletion(tr("Station named \u2018")+t+tr("\u2019 has been removed."),e,"currentlist",function(){UI.updateList(!0)});}$(this).val("icon")}),$("#addchecked").on("click",function(){$(".selected").each(function(){var e=$(this).data("meta");currentlist.push({name:e.name,url:e.url,homepage:e.homepage,icon:e.favicon,country:e.country,state:e.state,language:e.language,tags:e.tags,id:e.id})}),UI.updateList(!0),UI.dialog.close()}),$(document).on("blur",".itemname",function(){$(this).next().find(".okay").hide(),$(this).next().find(".renamelist").show();var e=$(this),t=$(this).closest("[data-item]").data("item"),s=e.val().trim().replace(/\s+/g," ")||null;t!=s&&(lists[s]==null?s?(lists[t]?(lists[s]=lists[t].slice(),delete lists[t]):(lists[s]=[],UI.hint.show(tr("New list named \u2018")+s+tr("\u2019 created"))),$("#lists").val()==t&&(listname=s),applyLists()):(UI.hint.show(tr("Invalid name")),applyLists()):(UI.hint.show(tr("Already existing")),applyLists()))}).on("focus",".itemname",function(){$(this).next().find(".okay").show(),$(this).next().find(".renamelist").hide(),$(this).select()}).on("keydown","div[data-item] > .itemname",function(e){13==e.which&&(e.preventDefault(),$(this).blur())}),$("#customstations input").on("keydown",function(e){13==e.which&&$(this).blur()}),$("#listtools").on("mouseenter",function(){$(this).css({opacity:1})}).on("mouseleave",function(){$(this).css({opacity:.5})}),$("#deselectall").on("click",function(){$(".selected").trigger("click")}),$("#results").on("click",".result",function(){if($(this).hasClass("selected")?($(this).removeClass("selected"),0==$(".selected").length&&$("#addfooter").css({top:"100%",visibility:"hidden"}),$(this).children().first().css({width:0,opacity:0})):Data.list.stationExists($(this).data("meta").id)?UI.message(tr("\u2018")+$(this).data("meta").name+tr("\u2019 has already been added to \u2018")+listname+tr("\u2019.")):($(this).addClass("selected"),$("#addfooter").css({top:"calc(100% - "+$("#addfooter").height()+"px)",visibility:"visible"}),$(this).children().first().css({width:"25px",opacity:1})),1==$(".selected").length?$("#stationcount").html(tr("\u2018")+$(".selected").data("meta").name+tr("\u2019")):$("#stationcount").html($(".selected").length+tr(" stations")),0<$(".selected").length){var e="calc(100% - "+$("#addfooter").height()+"px)";$("#addfooter").css({top:e}),$("#modals").css({height:e})}else $("#modals").css({height:"100%"})});var c=!1;$("#volumeslider").on("mousedown touchstart",function(t){c=!0,Player.volume.moveSlider(t)});var p,h,m,g,u,f=!1;$("#stations").on("mousedown","tr",function(t){f=!0,p=$(this).index(),u=p,h=$(this),$("#tomove").html(h[0].outerHTML.replace(/id=/g,"")),m=t.pageY,$("#tomove").css({height:h.height(),width:h.width(),left:h.offset().left,top:h.offset().top-$(window).scrollTop()})});var v;$(document).on("mousemove touchmove",function(t){if(f){$("html").addClass("dragging"),$("#tomove").show(),clearInterval(v),v=void 0,g=t.pageY;var e=function(e){u=Math.floor((e-$("#stations").offset().top)/$("#stations tr").height()),0>u?u=0:u>=$("#stations tr").length&&(u=$("#stations tr").length-1),$("#stations tr").removeClass("hovered"),$("#stations tr:nth-child("+(u+1)+")").addClass("hovered");var t=h.offset().top+e-m-$(window).scrollTop(),s=$("#stations").offset().top-$(window).scrollTop(),a=$("#stations").offset().top+$("#stations").height()-$("#tomove").height()-$(window).scrollTop();t<s?$("#tomove").css({transform:"translateY("+(s-t)+"px)"}):t>a?$("#tomove").css({transform:"translateY("+(a-t)+"px)"}):$("#tomove").css({transform:""}),$("#tomove").css({top:t})},s=parseInt($("#tomove").css("top"),10);s<=50+$(".videobar").outerHeight()?v=setInterval(function(){$(window).scrollTop($(window).scrollTop()-20),g-=20,e(g)},10):0>=$(window).height()-s-$("#tomove").height()?v=setInterval(function(){$(window).scrollTop($(window).scrollTop()+20),g+=20,e(g)},10):e(g)}else c&&Player.volume.moveSlider(t)}).on("mouseup touchend",function(){$("html").removeClass("dragging"),f?(f=!1,clearInterval(v),v=void 0,$("#tomove").hide(),$("#tomove").empty(),u!=p&&(Data.moveArrayIndex(currentlist,p,u),UI.updateList(!0)),$("#stations tr").removeClass("hovered")):c&&(c=!1)}).on("click","#stations tr",function(){$(this).hasClass("playing")?$(".stop:first").trigger("click"):Player.stream.start(currentlist[$(this).index()])}).on("click","#stations td:nth-child(3)",function(t){t.stopPropagation()})}var allids,liking=!1,searching=!1;const Network={radioBrowser:{browse:function(){for(var e=["countries","states","languages"],t=0;t<e.length;t++)(function(e){var t=$("[data-type="+e+"]");t.parent().prop("disabled")&&$.post("https://www.radio-browser.info/webservice/json/"+e,function(s){var a="<option value=''>"+tr("All ")+tr(e)+"</option>";for(var o in s)a+="<option value='"+s[o].name+"'>"+s[o].name+"</option>";t.html(a).parent().prop("disabled",!1)}).fail(function(){t.html("<option value=\"\">"+tr("Request failed")+"</option>"),$("#failmsg").slideDown()})})(e[t])},likeStation:function(e){liking||-1!=likes.indexOf(e)?$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+e,function(e){UI.message(e[0].votes+"+"+tr(" people like this station.")+"<br>"+tr("You have already voted."))}):(liking=!0,$.post("https://www.radio-browser.info/webservice/json/vote/"+e,function(){if(likes.push(e),Data.refresh(),!player.paused&&prevstation.id==e){var t=$(".like").attr("title").split("\n").pop().split("+")[0];$(".like").attr("title",$(".like").attr("title").replace(t,++t))}$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+e,function(e){UI.message(e[0].votes+"+"+tr(" people like this station.")+"<br>"+tr("Your like has been submitted to the Community Radio Browser.")),$(".like").addClass("active"),$(".likecounter").text(e[0].votes)})}).fail(function(){navigator.onLine?UI.message(tr("Sorry, an error has occurred. Please try again later.")):UI.message(tr("Please make sure that you are online."))}).always(function(){liking=!1}))},loadEntries:function(e){requesting=!0,fetch=$.post("https://www.radio-browser.info/webservice/json/stations/search",{name:e,offset:offset,limit:20,country:$("#country").val(),state:$("#state").val(),language:$("#language").val(),order:$("#order").val(),reverse:5>$("#order").prop("selectedIndex")?$("#reverse").hasClass("checked"):!$("#reverse").hasClass("checked")},function(e){$("#failure").hide(),requesting=!1;for(var t=0,s="",a=[null,"flag","map-marker","comment-alt fa-flip-horizontal","file-audio","play","thumbs-up"],o=0;o<e.length;o++){if($("#showbroken").hasClass("checked")||"1"==e[o].lastcheckok){var l=!0;for(var n in currentlist)if(currentlist[n].id==e[o].id){l=!1;break}if(s+="<div style='cursor: pointer; display: table; table-layout: fixed; width: 100%"+(l?"":"; opacity: .5; cursor: not-allowed' title='"+tr("This station has already been added to \u2018")+listname+tr("\u2019."))+"' data-meta='"+JSON.stringify(e[o]).replace(/'/g,"&apos;")+"' class='result'><div class='checkmark green' style='display: table-cell; opacity: 0; width: 0'><i class='fa fa-check' style='margin-left: 10px'></i></div><div style='padding: 10px; margin-bottom: 10px; display: table-cell'><h4 style='margin: 0'>"+(l?"":"<i class='fa fa-ban red'></i> ")+e[o].name+"</h4><br>"+(0==e[o].lastcheckok?"<span class='label red' style='font-weight: 500'>"+tr("BROKEN")+"</span> ":"")+(0<$("#order").prop("selectedIndex")?"<span class='label green' style='font-weight: 500'><i class='fa fa-"+a[$("#order").prop("selectedIndex")]+"'></i> "+(e[o][$("#order").val()]||"<i class='fa fa-question'></i>")+"</span> ":"")+(+e[o].hls?"<span class='label'>HLS</span> ":+e[o].bitrate?"<span class='label'>"+e[o].bitrate+" kBit/s</span> ":"")+(1==$("#order").prop("selectedIndex")?"":"<span class='label'>"+e[o].country+"</span> ")+(2==$("#order").prop("selectedIndex")?"":"<span class='label'>"+e[o].state+"</span> "),""!=e[o].tags)for(var n=0;n<e[o].tags.split(",").length;n++)s+="<span class='label'>"+e[o].tags.split(",")[n].trim()+"</span> ";else s+="<br>";s+="</div></div>"}else console.warn("'"+e[o].name+"' ["+(o+offset)+"] seems to be BROKEN.");t++}0==offset&&($("#results").empty(),$("#loadmore").show()),$("#results").append(s),20>t?(searching=!1,$("#loadmore").hide(),0==$("#results > div").length&&$("#results").html("<p style='font-size: 18px; text-align: center'><i class='far fa-fw fa-meh'></i>"+tr("No matching stations found.")+"</p>")):searching=!0,clearInterval(closetimer),$("#results").show(),console.info("Got "+$("#results > div").length+" results."),$("#modals").trigger("scroll")}).fail(function(e){"abort"!=e.statusText&&(searching=!1,requesting=!1,$("#loadmore").hide(),$("#results").hide(),$("#failure").show())})}},musicBrainz:{findAlbum:function(e,t){e.match(/ \/ | - |: /g)?$.get("https://musicbrainz.org/ws/2/recording/?fmt=json&query="+encodeURIComponent(e.replace(/ \/ | - |: /g," AND ")),function(s){if(s.count){for(var a,o=s.recordings[0],l=o.title,n=o["artist-credit"][0].artist.name,r=[],d=0;d<s.count;d++)if(a=s.recordings[d],a)for(var c=a.releases||[],p=0;p<c.length;p++){var h=c[p],m=h["release-group"].id;-1!=r.indexOf(m)||t==m||h["release-group"]["secondary-types"]&&-1==h["release-group"]["secondary-types"].indexOf("Soundtrack")||-1==e.toLowerCase().indexOf(h.media[0].track[0].title.toLowerCase())||a.title!=h.title&&h["artist-credit"]&&n!=h["artist-credit"][0].artist.name||r.push(m)}Network.musicBrainz.requestCover(r,l,!1)}else console.log("Nothing found")}).fail(function(){console.log("It failed! Sorry\u2026")}):console.log("Malformed title")},requestCover:function(e,t,s){console.log(e),e.length?$.get("https://coverartarchive.org/release-group/"+e[0],function(e){console.log("SUCCESS");for(var t=e.images[0].thumbnails.large,s=0;s<e.images.length;s++)if(e.images[s].front){t=e.images[s].thumbnails.large;break}$("#vcontain").css({"background-image":"url("+t+")"})}).fail(function(){Network.musicBrainz.requestCover(e.slice(1),t,s)}):s?Network.musicBrainz.findAlbum(t,allids):console.log("Nothing found")},coverart:!1,getCoverArt:function(e){if(Network.musicBrainz.coverart){if($("#vcontain").show(),!e||-1!=e.toLowerCase().indexOf(currentstation.toLowerCase()))return void console.log("Invalid song title");$("#coverart h3").text(e);var t=e.replace(","," ").replace(/[^feat.a-zA-Z\d!\s:\/-]/g,"*");$.get("https://musicbrainz.org/ws/2/release-group/?fmt=json&query="+encodeURIComponent(t.replace(/ \/ | - |: /g," AND ")),function(s){for(var a,o=[],l=0;l<s.count;l++)a=s["release-groups"][l],a&&100==a.score&&("Single"==a["primary-type"]||"EP"==a["primary-type"])&&-1!=e.toLowerCase().indexOf(a["artist-credit"][0].artist.name.toLowerCase())&&o.push(a.id);allids=o,Network.musicBrainz.requestCover(o,t,!0)}).fail(function(){console.log("It failed! Sorry\u2026")})}}}};var hasvideo,updatetimer,info,bartimer;const Player={volume:{change:function(e,t){var s=player.volume;e?s+=.1:s-=.1,1<s?s=1:0>s&&(s=0),player.volume=s.toFixed(1);var a=100*player.volume;t&&UI.hint.show("<i style='font-size: 60px' class='fa fa-volume-"+(0<a?"up":"off")+"'></i><div style='font-size: 25px'>"+(0<a?a+"%":tr("Off"))+"</div>",!0),$("#volumeslider div").css({width:a+"%"})},moveSlider:function(t){t.preventDefault();var e=+(((t.type.startsWith("touch")?t.changedTouches[0].pageX:t.pageX)-$("#volumeslider").offset().left)/$("#volumeslider").width()).toFixed(2);0>e?e=0:1<e&&(e=1),player.volume=e,$("#volumeslider div").css({width:(100*e).toFixed()+"%"})}},update:{setName:function(e){prevdata!=e&&($(".broadcaster").attr("title",e),e==nostream?(e=nostream,$("#tags").slideUp(),$(".like, .homepage, .plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()}),$("title").html(appname),Effects.changeColor(),Effects.visualization.disable(),Effects.relaxMode.leave(),$(".stop").children().removeClass("fa-stop").addClass("fa-play")):(e!=loading&&($("title").html(e+" - "+appname),currentstation=e,Effects.changeColor(),vinterval==null&&Effects.visualization.enable(),settings.relax&&(clearTimeout(relaxtimer),relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"]))),$(".stop").children().removeClass("fa-play").addClass("fa-stop")),$(".broadcaster").css({opacity:0}),setTimeout(function(){$(".broadcaster, #relaxcaption div:eq(0)").html(e).css({opacity:1})},400),prevdata=e)},setInfo:function(e){if(e!=info){if($(".info").attr("title",e),$(".info").css({opacity:0}),setTimeout(function(){$(".info, #relaxcaption div:eq(1)").html(e).css({opacity:1})},400),"<br>"==e)$("#vcontain").hide(),$(".info").slideUp();else if($("#vcontain").css({"background-image":""}),Network.musicBrainz.getCoverArt(e),$(".info").slideDown(),e){$(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideDown():$(this).show()});for(var t=0;t<titles.history.length;t++)titles.history[t].station==currentstation&&titles.history[t].info==e&&titles.history.splice(t,1);5==titles.history.length&&titles.history.splice(0,1),titles.history.push({station:currentstation,info:e,time:Math.floor(+new Date/60)}),Data.refresh();var s=titles.favorites[titles.favorites.length-1];s&&s.station==currentstation&&s.info==e?$(".plushistory").addClass("active"):$(".plushistory").removeClass("active"),$("#recent").is(":visible")&&JSON.stringify(titles.history)!=$("#recent").data("content")&&$(".reload").show()}else $(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()});info=e}}},stream:{start:function(t){const s=function(){Player.update.setName("<i class='fa fa-spin fa-spinner'></i> "+tr("Loading\u2026"))};Player.stream.stop(),s(),$("body").css({scrollTop:0}),UI.assignStatePlaying(t),$("#tags").html("<span class='label'>"+t.country.trim()+"</span> <span class='label'>"+t.state.trim()+"</span> ");var a=t.tags.split(",");for(var o in a)$("#tags").append("<span class='label'>"+a[o].trim()+"</span> ");$("#tags").slideDown(),$(".like, .homepage").each(function(){$(this).closest("#infobox").length?$(this).slideDown():$(this).show()}),$(".homepage").attr("href",t.homepage).attr("title",tr("Visit homepage")+"\n"+new URL(t.homepage).hostname),-1!=likes.indexOf(t.id)&&$(".like").addClass("active"),$.post("https://www.radio-browser.info/webservice/json/stations/byid/"+t.id,function(e){$(".like").attr("title",tr("Like")+"\n"+e[0].votes+"+"+tr(" people like this station.")),$(".likecounter").text(e[0].votes)}),player.ontimeupdate=function(){hasvideo!=0<player.videoHeight&&(hasvideo=0<player.videoHeight,0<player.videoHeight?($("#vcontain").show(),$(".fsdiv").show(),$(document).trigger("scroll"),Effects.relaxMode.leave()):$("#vcontain").hide())},player.onloadedmetadata=function(){prevstation=t,localStorage.lastStation=JSON.stringify(t),Player.update.setName(t.name);var e=function(){metarequest=$.post("https://service.radiolise.com/",{url:player.src},function(e){var s=e.name||t.name;if(Player.update.setName(s),e.title||!$("<div/>").html(info).text()){var a=e.title||e.description||"";s.toLowerCase()==a.toLowerCase()?Player.update.setInfo("<br>"):Player.update.setInfo(a)}}).always(function(){updatetimer||(updatetimer=setTimeout(function(){updatetimer=void 0,e()},1e4))})};e(),$("#external").attr("href",t.url),$("#external").show(),console.info("Started streaming '"+t.name+"'")},player.onwaiting=function(){prevdata!=loading&&UI.hint.show("load")},player.oncanplay=function(){UI.hint.hide()},player.load();var i=function(a){a||(a=""),navigator.onLine?"m3u8"==function(e){if(!e)return"";var t=e.lastIndexOf("/");return-1!==t&&(e=e.substring(t+1)),t=e.indexOf("?"),-1!==t&&(e=e.substring(0,t)),t=e.indexOf("#"),-1!==t&&(e=e.substring(0,t)),t=e.lastIndexOf("."),-1===t?"":e.substring(t+1)}(a)?(s(),hls.loadSource("https:"==location.protocol?a.replace("http:","https:"):a),hls.attachMedia(player)):(player.setAttribute("src","https://service.radiolise.com/?url="+encodeURIComponent(a)+"&play=1"),player.play().catch(function(s){errormessage=s.message,Player.stream.stop(),"AbortError"==s.name?Player.update.setName(nostream):"NotAllowedError"==s.name?(UI.message(tr("User gesture seems to be required. Click on \u2018")+t.name+tr("\u2019 to start the stream.")),Player.update.setName(nostream)):a.endsWith("/;")?(UI.message(tr("Sorry, an error has occurred. ")+errormessage),Player.update.setName(nostream)):(a==t.url?i((a+"/;").replace("//;","/;")):i(t.url),UI.assignStatePlaying(t))})):(Player.stream.stop(),Player.update.setName(nostream),UI.message(tr("Please make sure that you are online.")))};t.id?$.post("https://www.radio-browser.info/webservice/v2/json/url/"+t.id,function(e){i(e.url)}).fail(function(){i(t.url)}):i(t.url)},stop:function(){$("#vcontain").hide(),$(".fsdiv").hide(),$(".like").removeClass("active"),$(".plushistory").each(function(){$(this).closest("#infobox").length?$(this).slideUp():$(this).hide()}),$(document).trigger("scroll"),hasvideo=!1,$(".fullscreen i").hasClass("fa-compress")&&$(".fullscreen").trigger("click"),hls.detachMedia(),hls.stopLoad(),$(".stop").children().hasClass("fa-stop")&&console.info("Stopped streaming"),UI.assignStatePlaying(null),$("#hint").find(".fa-spinner").length&&UI.hint.hide(),player.onerror=null,player.removeAttribute("src"),player.load(),Effects.visualization.disable(),Player.update.setInfo("<br>"),metarequest&&metarequest.abort(),clearTimeout(updatetimer),updatetimer=void 0}},showVideoBar:function(){clearTimeout(bartimer),$(".videobar, .stationdiv").finish().show(),$("#video").css({cursor:"auto"}),0<player.videoHeight&&$("#video").hasClass("fs")&&(bartimer=setTimeout(function(){$(".videobar, .stationdiv").fadeOut(),$("#video").css({cursor:"none"})},3e3))}};var modaltimer,closetimer;const UI={adjust:function(){$("#themestyle").attr("href","css/"+(["pure-dark","pure","chic","chic-dark"][settings.theme-2]||"pure")+".css?v=3"),$("#splash").css({"background-image":"none","pointer-events":"none",opacity:0}),setTimeout(function(){$("#splash").remove()},2e3),(""==prevcolor||3!=settings.theme)&&Effects.changeColor(),player.paused||(settings.visualization?vinterval==null&&Effects.visualization.enable():Effects.visualization.disable(),clearTimeout(relaxtimer)),settings.transitions?$("#notransitions").remove():0==$("#notransitions").length&&$("head").append("<style id=\"notransitions\">\n  * {\n    transition: none !important;\n  }\n</style>"),console.info("User interface adjusted")},assignStatePlaying:function(e){if($("#stations .playbutton > i").addClass("fa-play").removeClass("fa-stop"),$("#stations > tr").removeClass("playing"),e)for(var t in currentlist)JSON.stringify(currentlist[t])==JSON.stringify(e)&&($("#stations .playbutton:eq("+t+") > i").addClass("fa-stop").removeClass("fa-play"),$("#stations > tr:eq("+t+")").addClass("playing"))},updateList:function(e){e&&Data.list.sync(!0),$("#stations").empty();for(var t,s=0;s<currentlist.length;s++){t="<tr><td style='vertical-align: middle'><div><div class='playbutton'><i style='display: table-cell; vertical-align: middle' class='fa fa-fw fa-play'></i></div><div class='icontain'><img class='icon' src='"+(settings.loadpolicy?currentlist[s].icon:"")+"' onerror='$(this).replaceWith(\"<div class=\\\"icon\\\" style=\\\"background: hsl("+20*currentlist[s].name.toUpperCase().charCodeAt(0)+", 50%, 50%)\\\"><span>"+currentlist[s].name[0].toUpperCase()+"</span></div>\")'></div></div></td><td><div style='display: block; padding-bottom: 20px'><div><h4 style='font-weight: 500; display: inline'>"+currentlist[s].name+"</h4></div></div><div style='position: relative; overflow: hidden; height: 30px'><div style='position: absolute; overflow-x: scroll; overflow-y: hidden; width: 100%' class='tags'><div style='white-space: nowrap; height: 30px'><span class='label'>"+currentlist[s].country+"</span> <span class='label'>"+currentlist[s].state+"</span> ";for(var a=0;a<currentlist[s].tags.split(",").length;a++)t+="<span class='label'>"+currentlist[s].tags.split(",")[a].trim()+"</span> ";t+="</div></div></div></div></td><td style='padding-right: 15px'><select class='smartmenu' title='"+tr("Options for \u2018")+currentlist[s].name+tr("\u2019")+"'><option selected hidden value='icon'>&#xf142;&nbsp;</option><optgroup label='"+tr("Options for \u2018")+currentlist[s].name+tr("\u2019")+"'><option value='like'>"+tr("Like")+"</option><option value='homepage'>"+tr("Visit homepage")+"</option><option value='edit'>"+tr("Edit")+"</option>"+(0<s?"<option value='moveup'>"+tr("Move up")+"</option>":"")+(s<currentlist.length-1?"<option value='movedown'>"+tr("Move down")+"</option>":"")+"<option value='delete'>"+tr("Delete")+"</option></optgroup><option>"+tr("Cancel")+"</option></select></td></tr>",$("#stations").append(t)}player.paused||UI.assignStatePlaying(prevstation),0==currentlist.length?$("#zero").show():($("#zero").hide(),$("#stations").show())},hint:{show:function(e,t,s){clearTimeout(hinttimer),$("#navbar, .videobar").css({opacity:.5}),$("#hint").css({opacity:1,visibility:"visible"}),"load"==e?0==$("#hint .fa-spinner").length&&$("#hint > div").html("<i style='font-size: 60px; margin: 16px 0' class='fa fa-spinner fa-spin'></i>"):$("#hint > div").html(e);var a=5e3;s?$("#hint > div").append("<div style='text-align: right'><a onclick='UI.hint.hide()' class='button'>"+tr("OK")+"</a></div>"):"load"!=e&&(hinttimer=setTimeout(function(){UI.hint.hide()},a)),t||"load"==e?($("#hint > div").css({width:"100px"}),a=2e3):$("#hint > div").css({width:"300px"}),$("#hint > div").css({transform:"scale(1, 1)"})},hide:function(){$("#navbar, .videobar").css({opacity:1}),$("#hint").css({opacity:0,visibility:"hidden"}),$("#hint > div").css({transform:"scale(1, .5)"})}},message:function(e){UI.hint.show(e,!1,!0)},dialog:{open:function(e){const t=function(e){"hint"!=e&&($("#modals").css({left:"0",opacity:1,visibility:"visible","pointer-events":"auto"}),$("body").addClass("dialog")),"addstation"==e?(Network.radioBrowser.browse(),$("#query").trigger("input"),$("#loadmore").show(),setTimeout(function(){$("#query").select()},100)):"stationmanager"==e?($("#stationname").text(currentlist[gearclicked].name),$("#customstations").show(),$("[placeholder='"+tr("Name")+"']").val(currentlist[gearclicked].name),$("[placeholder='"+tr("URL")+"']").val(currentlist[gearclicked].url),$("[placeholder='"+tr("Homepage")+"']").val(currentlist[gearclicked].homepage),$("[placeholder='"+tr("Icon")+"']").val(currentlist[gearclicked].icon),$("[placeholder='"+tr("Country")+"']").val(currentlist[gearclicked].country),$("[placeholder='"+tr("State")+"']").val(currentlist[gearclicked].state),$("[placeholder='"+tr("Language")+"']").val(currentlist[gearclicked].language),$("[placeholder='"+tr("Tags")+"']").val(currentlist[gearclicked].tags),UI.stationManager.refreshTagItems(currentlist[gearclicked].tags||"")):"history"==e&&(UI.titleManager.insertList("favorites"),UI.titleManager.updateTimes()),$("#modals").scrollTop(0),$("#"+e).show().addClass("shown"),$("#modals > div:not(#"+e+")").hide(),"hint"!=e&&history.pushState(null,null,"#dialog"),Effects.relaxMode.leave(),console.info("Dialog with tag ID "+e+" shown")};"#dialog"==location.hash?$(".shown").attr("id")!=e||"stationmanager"==e?(clearTimeout(modaltimer),modaltimer=setTimeout(function(){t(e)},400),UI.dialog.close(!0)):UI.dialog.close():t(e)},close:function(e){"listmanager"==$(".shown").attr("id")&&applyLists(),$("#modals").css({left:"-200px",opacity:0,visibility:"hidden","pointer-events":"none"}),e||$("body").removeClass("dialog"),"#dialog"==location.hash&&(history.back(),$(window).trigger("mousemove")),$(".shown").has("#addstation")&&($("#addfooter").css({top:"100%",visibility:"hidden"}),$("#modals").css({height:"100%"}),closetimer=setTimeout(function(){$("#query").val(""),$("#results").hide()},400)),$(".shown").removeClass("shown"),clearTimeout(relaxtimer),settings.relax&&(relaxtimer=setTimeout(function(){Effects.relaxMode.enter()},1e3*settings["relax-timeout"])),console.info("Dialog hidden")}},search:{refreshResults:function(){$("#query").trigger("input"),UI.search.showLoadingInfo()},showLoadingInfo:function(){requesting&&($("#results").empty(),$("#loadmore").show())}},settings:{toggleThemeDescription:function(){$("#descriptions > span").hide(),$("#"+$("#theme").val()).show()}},stationManager:{refreshTagItems:function(e){if($("#preview").empty(),e.trim()){var t=e.split(",");for(var s in t)$("#preview").append("<span class='label'>"+t[s].trim()+"</span> ");$("#tagview").show()}else $("#tagview").hide()}},titleManager:{insertList:function(e){moment.locale(language);var t="";if(0<titles[e].length)for(var s,a,o=titles[e].length-1;0<=o;o--){if(a=titles[e][o],"favorites"==e){var l=moment(60*a.time).format("MMMM YYYY");s!=l&&(t+="<div class='monthseparator' style='margin: 10px 0; padding: 5px 10px; font-size: 20px; font-weight: 500; opacity: .7'>"+l+"</div>",s=moment(60*a.time).format("MMMM YYYY"))}t+="<div class='listitem' style='padding: 10px'><div style='margin-bottom: 5px; font-weight: normal; font-size: 17px; font-weight: 500'>"+a.info+"</div><div style='opacity: .7'><span style='float: left'>"+a.station+"</span>&nbsp;<span data-time='"+a.time+"' style='float: right'>"+moment(60*a.time).fromNow()+"</span></div><div class='options' style='display: none'>"+("favorites"==e?"<a class='button' href='https://musicbrainz.org/search?query="+encodeURIComponent(a.info)+"&type=recording' target='_blank' style='margin-bottom: 0'><i class='fa fa-fw fa-search'></i><span tr>MusicBrainz</span></a><a class='button' style='margin-bottom: 0' onclick='Data.offerUndeletion(\""+tr("\u2018")+a.info+tr("\u2019 has been removed from bookmarks.")+"\", titles.favorites.slice(), \"bookmarks\", function() {Data.refresh(); UI.titleManager.insertList(\"favorites\")}); titles.favorites.splice("+o+", 1); Data.refresh(); UI.titleManager.insertList(\"favorites\")'><i class='fa fa-fw fa-times'></i><span>"+tr("Remove")+"</span></a>":"<a class='button' style='margin-bottom: 0' onclick='Data.createBookmark("+JSON.stringify(a)+")'><i class='fa fa-music'></i><i class='fa fa-fw fa-xs fa-plus' style='vertical-align: super; margin: 0'></i><span>"+tr("Bookmark")+"</span></a><a class='button' href='https://musicbrainz.org/search?query="+encodeURIComponent(a.info)+"&type=recording' target='_blank' style='margin-bottom: 0'><i class='fa fa-fw fa-search'></i><span tr>MusicBrainz</span></a>")+"</div></div>"}else t+=tr("<p style='padding: 0; text-align: center'>"+tr("This list is currently empty.")+"</p>");if($("#"+("favorites"==e?"favorites":"recent")).html(t).data("content",JSON.stringify(titles[e])),"favorites"==e){var n=titles.favorites[titles.favorites.length-1];n&&n.station==currentstation&&n.info==info?$(".plushistory").addClass("active"):$(".plushistory").removeClass("active"),0<titles.favorites.length?$(".download").show():$(".download").hide()}console.info("Wrote "+e)},updateTimes:function(){timeupdater&&clearTimeout(timeupdater),timeupdater=setInterval(function(){var e=0;$("#history").hasClass("shown")&&$(":visible > .listitem [data-time]").each(function(){var t=moment(60*$(this).data("time")).fromNow();$(this).text()!=t&&$(this).text(t),e++}),0==e&&clearTimeout(timeupdater)},5e3)}}};window.onunload=Player.stream.stop;function tr(e){return i18next.t(e)}window.onoffline=function(){player.paused||UI.message(tr("Oh no! The stream was interrupted due to a sudden disconnect.")),Player.stream.stop(),Player.update.setName(nostream)},"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js");var lists,settings,currentstation,prevdata,prevvolume,prevstation,defaultdata,loading,gearclicked,hinttimer,volumetimer,volumerequest,slow,timedout,relaxtimer,currentlist,likes,titles,fetch,nostream,listname,metarequest,timeupdater,defaultsettings="{\"theme\":4,\"visualization\":false,\"relax\":false,\"relax-timeout\":10,\"changecolor\":false,\"volume\":100,\"transitions\":true,\"loadpolicy\":true,\"language\":\"auto\"}",player=$("video")[0],appname=$("title").text(),visible=!1,listsbackup={},ismousedown=!1;console.log("%c Welcome to "+appname+"! ","font-size: 30px; background-color: #ccc; color: #000; font-family: sans-serif"),console.log("%c > and Happy Hacking!_","font-size: 20px"),console.log("%c\nhttps://gitlab.com/radiolise/radiolise.gitlab.io\n\n","font-family: sans-serif; font-size: 14px"),console.info("%c"+appname+" is free software, and you are welcome to redistribute it under certain conditions; type%c learnMore() %cfor details.","font-size: 14px; font-family: sans-serif","font-size: 14px","font-size: 14px; font-family: sans-serif"),player.onpause=function(){Player.stream.stop(),Player.update.setName(nostream)},player.onplay=function(){null==player.getAttribute("src")&&$(".stop:first").trigger("click")},$("title").text(appname);var errormessage,hls=new Hls;hls.on(Hls.Events.MANIFEST_PARSED,function(){UI.hint.hide(),player.play()}),hls.on(Hls.Events.ERROR,function(e,t){Player.stream.stop(),Player.update.setName(nostream),UI.message(tr("Sorry, an error has occurred. ")+(Hls.isSupported()?"levelLoadTimeOut"==t.details?tr("Timeout: Your network connection seems to be too slow at the moment."):t.details:tr("The stream may need a protocol like HLS, which doesn\u2019t seem to be supported by your browser.")))});function setList(e){$("#lists").val(e),listname!=e&&(listname=e,Data.list.sync(!1),localStorage.lastList=e)}function addList(){0==$("[data-item=\"\"]").length&&appendList(""),$("div[data-item=\"\"] > input").attr("placeholder",tr("Please specify a name")).select();var e=$("div[data-item=\"\"]").offset().top+$("#modals").scrollTop()-$("body").scrollTop();$("#modals").animate({scrollTop:e})}function removeList(e){var t=JSON.stringify(lists);delete lists[e],applyLists(),e==listname&&setList($("#lists > optgroup > option").html()),Data.offerUndeletion(tr("List named \u2018")+e+tr("\u2019 has been removed."),t,"list",applyLists)}function renameList(e){$("div[data-item=\""+e+"\"] > .itemname").focus()}function applyLists(){for(var e in Data.refresh(),$("#listdiv").empty(),$("#lists > optgroup").empty(),lists)$("#lists > optgroup").append("<option>"+e+"</option>"),appendList(e);$("#lists").val(listname)}function appendList(e){var t=document.createElement("input");t.setAttribute("class","itemname"),t.setAttribute("placeholder",tr("New name")),t.setAttribute("value",e);var s=document.createElement("div");s.setAttribute("data-item",e),s.setAttribute("style","display: table-row"),s.innerHTML=t.outerHTML+"<div style='display: table-cell; white-space: nowrap'><a class='renamelist' onclick='renameList($(this).closest(\"[data-item]\").data(\"item\"))'><i class='fa fa-fw fa-edit'></i></a><a class='okay' style='display: none'><i class='fa fa-fw fa-check'></i></a>"+(""!=e&&1<Object.keys(lists).length?"<a onclick='removeList($(this).closest(\"[data-item]\").data(\"item\"))'><i class='fa fa-fw fa-trash'></i></a>":"")+"</div>",$("#listdiv").append(s)}var languages=[];try{settings=JSON.parse(localStorage.data||"{\"settings\":{\"theme\":4,\"visualization\":false,\"relax\":false,\"relax-timeout\":10,\"changecolor\":false,\"volume\":100,\"transitions\":true,\"loadpolicy\":true,\"language\":\"auto\"}}").settings}catch(t){settings=JSON.parse(defaultsettings)}var prevlanguage=settings.language||"auto",language=prevlanguage;"auto"==language&&(language=navigator.language.substring(0,2),navigator.languages!=null&&(languages=navigator.languages.slice(),$.each(languages,function(e,t){languages[e]=t.substring(0,2)}),languages=Array.from(new Set(languages.slice(0,languages.includes("en")?languages.indexOf("en"):1/0)))));var detected=!1;i18next.use(i18nextXHRBackend).init({lng:"en"==language?null:language,fallbackLng:languages,nsSeparator:null,keySeparator:null,backend:{loadPath:"locales/{{lng}}.json?v=3"}},main);
